<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>BUUOJ_crypto | M4XLMUM</title><meta name="keywords" content="ctf,crypto"><meta name="author" content="M4XLMUM"><meta name="copyright" content="M4XLMUM"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="偶尔会做些crypto的题目，往后就把解题过程放在这一个文件里了 [TOC] 资源整合1.密码学网址 gmpy2库的基本使用 factordb在线大整数分解 维吉尼亚无key在线解密  2.知识点利用Crypto.PublicKey的RSA模块从文件中获取公钥信息n,e。from Crypto.PublicKey import RSA f &#x3D; open(&quot;key.pub&quot;,&quot;rb&quot;).read()">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUOJ_crypto">
<meta property="og:url" content="https://a16n.github.io/2020/11/25/BUUOJ-crypto/index.html">
<meta property="og:site_name" content="M4XLMUM">
<meta property="og:description" content="偶尔会做些crypto的题目，往后就把解题过程放在这一个文件里了 [TOC] 资源整合1.密码学网址 gmpy2库的基本使用 factordb在线大整数分解 维吉尼亚无key在线解密  2.知识点利用Crypto.PublicKey的RSA模块从文件中获取公钥信息n,e。from Crypto.PublicKey import RSA f &#x3D; open(&quot;key.pub&quot;,&quot;rb&quot;).read()">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://a16n.github.io/img/topimg/QQ%E6%88%AA%E5%9B%BE20210503194649.png">
<meta property="article:published_time" content="2020-11-25T13:46:23.000Z">
<meta property="article:modified_time" content="2021-05-07T16:35:38.930Z">
<meta property="article:author" content="M4XLMUM">
<meta property="article:tag" content="ctf">
<meta property="article:tag" content="crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://a16n.github.io/img/topimg/QQ%E6%88%AA%E5%9B%BE20210503194649.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://a16n.github.io/2020/11/25/BUUOJ-crypto/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="baidu_site_verification" content="Erg2Bytt6M"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-9257596953357662',
  enable_page_level_ads: 'true'
});</script><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":200,"languages":{"author":"作者: M4XLMUM","link":"链接: ","source":"来源: M4XLMUM","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: true,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-05-08 00:35:38'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const fontSizeVal = saveToLocal.get('global-font-size')
    if (fontSizeVal !== undefined) {
      document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
    }
    })(window)</script><meta name="generator" content="Hexo 5.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/logo.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">117</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">105</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 爱好</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/musics/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 番剧</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/galleries/"><i class="fa-fw fas fa-camera"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/topimg/QQ%E6%88%AA%E5%9B%BE20210503194649.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">M4XLMUM</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 爱好</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/musics/"><i class="fa-fw fas fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 番剧</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 书籍</span></a></li><li><a class="site-page child" href="/galleries/"><i class="fa-fw fas fa-camera"></i><span> 相册</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/friends/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">BUUOJ_crypto</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-11-25T13:46:23.000Z" title="发表于 2020-11-25 21:46:23">2020-11-25</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-05-07T16:35:38.930Z" title="更新于 2021-05-08 00:35:38">2021-05-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">8.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>43分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BUUOJ_crypto"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><strong>偶尔会做些crypto的题目，往后就把解题过程放在这一个文件里了</strong></p>
<p>[TOC]</p>
<h1 id="资源整合"><a href="#资源整合" class="headerlink" title="资源整合"></a>资源整合</h1><h2 id="1-密码学网址"><a href="#1-密码学网址" class="headerlink" title="1.密码学网址"></a>1.密码学网址</h2><ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43790779/article/details/108473984">gmpy2库的基本使用</a></li>
<li><a target="_blank" rel="noopener" href="http://www.factordb.com/index.php">factordb在线大整数分解</a></li>
<li><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">维吉尼亚无key在线解密</a></li>
</ul>
<h2 id="2-知识点"><a href="#2-知识点" class="headerlink" title="2.知识点"></a>2.知识点</h2><h3 id="利用Crypto-PublicKey的RSA模块从文件中获取公钥信息n-e。"><a href="#利用Crypto-PublicKey的RSA模块从文件中获取公钥信息n-e。" class="headerlink" title="利用Crypto.PublicKey的RSA模块从文件中获取公钥信息n,e。"></a>利用Crypto.PublicKey的RSA模块从文件中获取公钥信息n,e。</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"key.pub"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
pub <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>pub<span class="token punctuation">.</span>n<span class="token punctuation">,</span>pub<span class="token punctuation">.</span>e<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="对文件内容解密，集成PKCS1-OAEP"><a href="#对文件内容解密，集成PKCS1-OAEP" class="headerlink" title="对文件内容解密，集成PKCS1_OAEP"></a>对文件内容解密，集成PKCS1_OAEP</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">对文件加密，要用下面的脚本对文件解密
<span class="token triple-quoted-string string">"""
似乎要用下面封装好的对flag.enc文件内容进行解密，具体原因尚待考究。
"""</span>
key_info <span class="token operator">=</span> RSA<span class="token punctuation">.</span>construct<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span>
key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>key_info<span class="token punctuation">.</span>exportKey<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
key <span class="token operator">=</span> PKCS1_OAEP<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.enc'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
flag <span class="token operator">=</span> key<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="古典密码"><a href="#古典密码" class="headerlink" title="古典密码"></a>古典密码</h1><h2 id="1-古典-Cipher"><a href="#1-古典-Cipher" class="headerlink" title="1.古典-Cipher"></a>1.古典-Cipher</h2><pre class="line-numbers language-none"><code class="language-none">还能提示什么呢？公平的玩吧（密钥自己找） Dncnoqqfliqrpgeklwmppu<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>普莱费尔(playfair)密码</code>，密码表类似为</p>
<pre class="line-numbers language-none"><code class="language-none">p l a y f
i r b c d
e g h k m
n o q s t
u v w x z<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45784859/article/details/105766145">看大佬的解析吧，懒得看了</a><br><a target="_blank" rel="noopener" href="http://rumkin.com/tools/cipher/playfair.php">在线解playfair</a><br>解密为<code>Itisnotaproblemhavefun</code><br><code>flag&#123;itisnotaproblemhavefun&#125;</code></p>
<h2 id="2-古典-汉字的秘密"><a href="#2-古典-汉字的秘密" class="headerlink" title="2.古典-汉字的秘密"></a>2.古典-汉字的秘密</h2><p>当铺密码&lt;<code>原理即将汉字出头的头的个数转化为数字，如&lt;王:6,由:1,壮:9...等等&gt;，转为数字</code>&gt;，转为数字之后发现没超过127的和少于32的，所以转为ascii，然后得到<code>EJ&gt;CvSHMV7G9R9@?3k</code>，变异凯撒，用脚本解密</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#@m4xlmum</span>
<span class="token keyword">import</span> string

list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">69</span><span class="token punctuation">,</span> <span class="token number">74</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">118</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">72</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">]</span>
list2 <span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>

f <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment">#变异凯撒</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> list1<span class="token punctuation">:</span>
    f <span class="token operator">+=</span> <span class="token number">1</span>
    list2<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token operator">+</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token operator">+</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#转为小写</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> list2<span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token keyword">in</span> string<span class="token punctuation">.</span>ascii_uppercase<span class="token punctuation">:</span>
        i <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>FLAG&#123;YOU_ARE_GOOD&#125;</code>、<code>flag&#123;you_are_good&#125;</code></p>
<h2 id="3-莫斯-robomunication"><a href="#3-莫斯-robomunication" class="headerlink" title="3.莫斯-robomunication"></a>3.莫斯-robomunication</h2><p>是音频bi、bu两种音，分别对应于莫斯密码的短横线与点，这个全靠手动了，没什么好说的。</p>
<pre class="line-numbers language-morse" data-language="morse"><code class="language-morse">....&#x2F;.&#x2F;.-..&#x2F;.-..&#x2F;---&#x2F;.--&#x2F;....&#x2F;.-&#x2F;-&#x2F;..&#x2F;...&#x2F;-&#x2F;....&#x2F;.&#x2F;-.-&#x2F;.&#x2F;-.--&#x2F;..&#x2F;-&#x2F;..&#x2F;...&#x2F;-...&#x2F;---&#x2F;---&#x2F;.--.&#x2F;-...&#x2F;.&#x2F;.&#x2F;.--.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在线解密后为</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">HELLO WHAT IS THE KEY IT IS BOOPBEEP
flag&#123;BOOPBEEP&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2 id="4-八进制与ASCII-密码学的心声"><a href="#4-八进制与ASCII-密码学的心声" class="headerlink" title="4.八进制与ASCII-密码学的心声"></a>4.八进制与ASCII-密码学的心声</h2><p>这个给的数据跟提示在简谱上，注意到他提示八进制，ascii码。猜测应该是三个一组的八进制转为十进制再转为ASCII码。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
s <span class="token operator">=</span> <span class="token string">'111 114 157 166 145 123 145 143 165 162 151 164 171 126 145 162 171 115 165 143 150'</span>
data <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
flag <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># output: ILoveSecurityVeryMuch</span>
<span class="token comment"># flag&#123;ILoveSecurityVeryMuch&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="5-曼彻斯特编码-传感器"><a href="#5-曼彻斯特编码-传感器" class="headerlink" title="5.曼彻斯特编码-传感器"></a>5.曼彻斯特编码-传感器</h2><p>给的数据为</p>
<pre class="line-numbers language-data" data-language="data"><code class="language-data">5555555595555A65556AA696AA6666666955<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>提示为</p>
<pre class="line-numbers language-none"><code class="language-none">这是某压力传感器无线数据包解调后但未解码的报文(hex)
已知其ID为0xFED31F，请继续将报文完整解码，提交hex。
提示1：曼联<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>曼彻斯特编码是将数据转为二进制之后，将01电平跳变表示1, 10的电平跳变表示0，也就是<code>01-&gt;1、10-&gt;0</code>，开始的时候解出来的不对，后来看WP知道有八位倒序传输协议，需要每八位re一下。</p>
<p>bin-&gt;hex，对比ID并不重合，根据<code>八位倒序传输协议</code>将二进制每八位reverse，转hex</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> binascii


data <span class="token operator">=</span> <span class="token string">'5555555595555A65556AA696AA6666666955'</span>
ans <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    temp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
    temp <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>temp<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4</span><span class="token punctuation">:</span>
        temp <span class="token operator">=</span> <span class="token string">'0'</span> <span class="token operator">+</span> temp
    a <span class="token operator">=</span> temp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span>
    b <span class="token operator">=</span> temp<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> a <span class="token operator">==</span> <span class="token string">'01'</span><span class="token punctuation">:</span>
        ans <span class="token operator">+=</span> <span class="token string">'1'</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        ans <span class="token operator">+=</span> <span class="token string">'0'</span>


    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token string">'10'</span><span class="token punctuation">:</span>
        ans <span class="token operator">+=</span> <span class="token string">'0'</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        ans <span class="token operator">+=</span> <span class="token string">'1'</span>
temp <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    temp <span class="token operator">+=</span> ans<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>temp<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0x'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># FFFFFED31F645055F9</span>
<span class="token comment"># flag&#123;FFFFFED31F645055F9&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="6-变形rot加密-rot"><a href="#6-变形rot加密-rot" class="headerlink" title="6.变形rot加密-rot"></a>6.变形rot加密-rot</h2><p>看题的名字就知道了是rot了，给的数据如下</p>
<pre class="line-numbers language-data" data-language="data"><code class="language-data">83 89 78 84 45 86 96 45 115 121 110 116 136 132 132 132 108 128 117 118 134 110 123 111 110 127 108 112 124 122 108 118 128 108 131 114 127 134 108 116 124 124 113 108 76 76 76 76 138 23 90 81 66 71 64 69 114 65 112 64 66 63 69 61 70 114 62 66 61 62 69 67 70 63 61 110 110 112 64 68 62 70 61 112 111 112<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>解密，简单了解了rot加密的原理之后，先测试加减的位数，很明显变换是在ASCII表上进行的，并且前后的rot显然也不同，前面的ascii大都小于90，后面的ascii大都大于110，可见前面的是加个数，后面的是减去一个数，从而有如下脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
s <span class="token operator">=</span> <span class="token string">'83 89 78 84 45 86 96 45 115 121 110 116 136 132 132 132 108 128 117 118 134 110 123 111 110 127 108 112 124 122 108 118 128 108 131 114 127 134 108 116 124 124 113 108 76 76 76 76 138 23 90 81 66 71 64 69 114 65 112 64 66 63 69 61 70 114 62 66 61 62 69 67 70 63 61 110 110 112 64 68 62 70 61 112 111 112'</span>
data <span class="token operator">=</span> s<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token triple-quoted-string string">"""下面测出移动的位数
    for j in range(20):
        char = chr(d+j)
        if char == 'f':
            print(j)
    """</span>
    bit <span class="token operator">=</span> <span class="token number">19</span>
    char <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>d<span class="token operator">+</span>bit<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>char<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
flag2 <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> bit <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'bit ='</span><span class="token punctuation">,</span> bit<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>flag2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        char <span class="token operator">=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>d<span class="token operator">-</span>bit<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>char<span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210503220600094.png" alt="image-20210503220600094"></p>
<p>显然，位移为-13时的应该是答案，故flag为</p>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;www_shiyanbar_com_is_very_good_????&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>….原来????是还没确定的意思，我还以为已经好了…</p>
<p>再写个脚本爆破</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5
<span class="token keyword">import</span> string


flag <span class="token operator">=</span> <span class="token string">'flag&#123;www_shiyanbar_com_is_very_good_'</span>
md55 <span class="token operator">=</span> <span class="token string">'38e4c352809e150186920aac37190cbc'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> string<span class="token punctuation">.</span>printable<span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> string<span class="token punctuation">.</span>printable<span class="token punctuation">:</span>
        <span class="token keyword">for</span> a <span class="token keyword">in</span> string<span class="token punctuation">.</span>printable<span class="token punctuation">:</span>
            <span class="token keyword">for</span> b <span class="token keyword">in</span> string<span class="token punctuation">.</span>printable<span class="token punctuation">:</span>
                md555 <span class="token operator">=</span> flag <span class="token operator">+</span> i <span class="token operator">+</span> j <span class="token operator">+</span> a <span class="token operator">+</span> b <span class="token operator">+</span> <span class="token string">'&#125;'</span>
                <span class="token keyword">if</span> md55 <span class="token operator">==</span> md5<span class="token punctuation">(</span>md555<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>md555<span class="token punctuation">)</span>


<span class="token comment"># flag&#123;www_shiyanbar_com_is_very_good_@8Mu&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="7-变形base64-BJDCTF2020-这是base"><a href="#7-变形base64-BJDCTF2020-这是base" class="headerlink" title="7.变形base64-[BJDCTF2020]这是base??"></a>7.变形base64-[BJDCTF2020]这是base??</h2><p>给了变形对照的加密表，直接将原来的替换过来再解b64就OK了</p>
<pre class="line-numbers language-none"><code class="language-none">dict:&#123;0: &#39;J&#39;, 1: &#39;K&#39;, 2: &#39;L&#39;, 3: &#39;M&#39;, 4: &#39;N&#39;, 5: &#39;O&#39;, 6: &#39;x&#39;, 7: &#39;y&#39;, 8: &#39;U&#39;, 9: &#39;V&#39;, 10: &#39;z&#39;, 11: &#39;A&#39;, 12: &#39;B&#39;, 13: &#39;C&#39;, 14: &#39;D&#39;, 15: &#39;E&#39;, 16: &#39;F&#39;, 17: &#39;G&#39;, 18: &#39;H&#39;, 19: &#39;7&#39;, 20: &#39;8&#39;, 21: &#39;9&#39;, 22: &#39;P&#39;, 23: &#39;Q&#39;, 24: &#39;I&#39;, 25: &#39;a&#39;, 26: &#39;b&#39;, 27: &#39;c&#39;, 28: &#39;d&#39;, 29: &#39;e&#39;, 30: &#39;f&#39;, 31: &#39;g&#39;, 32: &#39;h&#39;, 33: &#39;i&#39;, 34: &#39;j&#39;, 35: &#39;k&#39;, 36: &#39;l&#39;, 37: &#39;m&#39;, 38: &#39;W&#39;, 39: &#39;X&#39;, 40: &#39;Y&#39;, 41: &#39;Z&#39;, 42: &#39;0&#39;, 43: &#39;1&#39;, 44: &#39;2&#39;, 45: &#39;3&#39;, 46: &#39;4&#39;, 47: &#39;5&#39;, 48: &#39;6&#39;, 49: &#39;R&#39;, 50: &#39;S&#39;, 51: &#39;T&#39;, 52: &#39;n&#39;, 53: &#39;o&#39;, 54: &#39;p&#39;, 55: &#39;q&#39;, 56: &#39;r&#39;, 57: &#39;s&#39;, 58: &#39;t&#39;, 59: &#39;u&#39;, 60: &#39;v&#39;, 61: &#39;w&#39;, 62: &#39;+&#39;, 63: &#39;&#x2F;&#39;, 64: &#39;&#x3D;&#39;&#125;

chipertext:
FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> string
<span class="token keyword">import</span> base64


dic1 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'J'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'K'</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">:</span> <span class="token string">'L'</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token string">'M'</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">:</span> <span class="token string">'N'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">:</span> <span class="token string">'O'</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">:</span> <span class="token string">'x'</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">:</span> <span class="token string">'y'</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">:</span> <span class="token string">'U'</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">:</span> <span class="token string">'V'</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">:</span> <span class="token string">'z'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">:</span> <span class="token string">'A'</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">:</span> <span class="token string">'B'</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">:</span> <span class="token string">'C'</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">:</span> <span class="token string">'D'</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">:</span> <span class="token string">'E'</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">:</span> <span class="token string">'F'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">:</span> <span class="token string">'G'</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">:</span> <span class="token string">'H'</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">:</span> <span class="token string">'7'</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">:</span> <span class="token string">'8'</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">:</span> <span class="token string">'9'</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">:</span> <span class="token string">'P'</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">:</span> <span class="token string">'Q'</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">:</span> <span class="token string">'I'</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">:</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">:</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">:</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">:</span> <span class="token string">'d'</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">:</span> <span class="token string">'e'</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">:</span> <span class="token string">'f'</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">:</span> <span class="token string">'g'</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">:</span> <span class="token string">'h'</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">:</span> <span class="token string">'i'</span><span class="token punctuation">,</span> <span class="token number">34</span><span class="token punctuation">:</span> <span class="token string">'j'</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">:</span> <span class="token string">'k'</span><span class="token punctuation">,</span> <span class="token number">36</span><span class="token punctuation">:</span> <span class="token string">'l'</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">:</span> <span class="token string">'m'</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">:</span> <span class="token string">'W'</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">:</span> <span class="token string">'X'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">:</span> <span class="token string">'Y'</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">:</span> <span class="token string">'Z'</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">:</span> <span class="token string">'0'</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">:</span> <span class="token string">'1'</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">:</span> <span class="token string">'2'</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">:</span> <span class="token string">'3'</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">:</span> <span class="token string">'4'</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">:</span> <span class="token string">'5'</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">:</span> <span class="token string">'6'</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">:</span> <span class="token string">'R'</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">:</span> <span class="token string">'S'</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">:</span> <span class="token string">'T'</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">:</span> <span class="token string">'n'</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">:</span> <span class="token string">'o'</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">:</span> <span class="token string">'p'</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">:</span> <span class="token string">'q'</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">:</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">:</span> <span class="token string">'s'</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">:</span> <span class="token string">'t'</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">:</span> <span class="token string">'u'</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">:</span> <span class="token string">'v'</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">:</span> <span class="token string">'w'</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">:</span> <span class="token string">'+'</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">:</span> <span class="token string">'='</span><span class="token punctuation">&#125;</span>
dic2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
strdic2 <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_uppercase <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> <span class="token string">'+/'</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>strdic2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    dic2<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> strdic2<span class="token punctuation">[</span>i<span class="token punctuation">]</span>

chipertext <span class="token operator">=</span> <span class="token string">'FlZNfnF6Qol6e9w17WwQQoGYBQCgIkGTa9w3IQKw'</span>

ans <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> chipertext<span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>dic1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> i <span class="token operator">==</span> dic1<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>
            ans <span class="token operator">+=</span> dic2<span class="token punctuation">[</span>j<span class="token punctuation">]</span>
flag <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># b'BJD&#123;D0_Y0u_kNoW_Th1s_b4se_map&#125;'</span>
<span class="token comment"># flag&#123;D0_Y0u_kNoW_Th1s_b4se_map&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="8-jsfuck-这是什么"><a href="#8-jsfuck-这是什么" class="headerlink" title="8.jsfuck-()[]+!-这是什么"></a>8.jsfuck-<code>()[]+!</code>-这是什么</h2><p>看到apk，顺手改成rar解压发现是doc，后缀名再改成doc，打开发现ciphertext</p>
<pre class="line-numbers language-ciphertext" data-language="ciphertext"><code class="language-ciphertext">[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+(![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(+![]+[![]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+!+[]]]+(![]+[])[+!+[]]+[+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[+[]]+([][[]]+[])[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]]+[+[]]+(+(+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(+![]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(+![]+[![]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]](!+[]+!+[]+[+[]])+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+[+!+[]]+[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[+[]]+[!+[]+!+[]]+[+[]]+[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+[!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([][[]]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(![]+[])[+!+[]]+[!+[]+!+[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(+![]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(+![]+[![]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(+![]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(+![]+[![]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()(([]+[])[([![]]+[][[]])[+!+[]+[+[]]]+(!![]+[])[+[]]+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]]()[+[]])[+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([][[]]+[])[!+[]+!+[]])+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]])()<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>发现是jsfuck之后首先想到的是找在线的网站，结果他在线的网站不中用，后来才想起来直接在控制台解密多好</p>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210503223932200.png" alt="image-20210503223932200"></p>
<p><code>flag&#123;a0448fd730b62c13ca80200c4529daa2&#125;</code></p>
<h2 id="9-维吉尼亚密码-MRCTF2020-vigenere"><a href="#9-维吉尼亚密码-MRCTF2020-vigenere" class="headerlink" title="9.维吉尼亚密码-[MRCTF2020]vigenere"></a>9.维吉尼亚密码-[MRCTF2020]vigenere</h2><p><img src="/2020/11/25/BUUOJ-crypto/image-20210504105314536.png" alt="image-20210504105314536"></p>
<p>懒得自己写爆破脚本，况且当key的位数也太长了，如果只有四位一下，可以尝试自己爆破，但是有在线的就显得十分没有必要了，网站在这篇文章头上。</p>
<pre class="line-numbers language-source_text" data-language="source_text"><code class="language-source_text">a declaration of the independence of cyberspace
by john perry barlow 
governments of the industrial world, you weary giants of flesh and steel, i come from cyberspace, the new home of mind. on behalf of the future, i ask you of the past to leave us alone. you are not welcome among us. you have no sovereignty where we gather.
we have no elected government, nor are we likely to have one, so i address you with no greater authority than that with which liberty itself always speaks. i declare the global social space we are building to be naturally independent of the tyrannies you seek to impose on us. you have no moral right to rule us nor do you possess any methods of enforcement we have true reason to fear.
governments derive their just powers from the consent of the governed. you have neither solicited nor received ours. we did not invite you. you do not know us, nor do you know our world. cyberspace does not lie within your borders. do not think that you can build it, as though it were a public construction project. you cannot. it is an act of nature and it grows itself through our collective actions.
you have not engaged in our great and gathering conversation, nor did you create the wealth of our marketplaces. you do not know our culture, our ethics, or the unwritten codes that already provide our society more order than could be obtained by any of your impositions.
you claim there are problems among us that you need to solve. you use this claim as an excuse to invade our precincts. many of these problems don&#39;t exist. where there are real conflicts, where there are wrongs, we will identify them and address them by our means. we are forming our own social contract. this governance will arise according to the conditions of our world, not yours. our world is different.
cyberspace consists of transactions, relationships, and thought itself, arrayed like a standing wave in the web of our communications. ours is a world that is both everywhere and nowhere, but it is not where bodies live.
we are creating a world that all may enter without privilege or prejudice accorded by race, economic power, military force, or station of birth.
we are creating a world where anyone, anywhere may express his or her beliefs, no matter how singular, without fear of being coerced into silence or conformity.
your legal concepts of property, expression, identity, movement, and context do not apply to us. they are all based on matter, and there is no matter here.
our identities have no bodies, so, unlike you, we cannot obtain order by physical coercion. we believe that from ethics, enlightened self-interest, and the commonweal, our governance will emerge. our identities may be distributed across many of your jurisdictions. the only law that all our constituent cultures would generally recognize is the golden rule. we hope we will be able to build our particular solutions on that basis. but we cannot accept the solutions you are attempting to impose.
in the united states, you have today created a law, the telecommunications reform act, which repudiates your own constitution and insults the dreams of jefferson, washington, mill, madison, detoqueville, and brandeis. these dreams must now be born anew in us.
you are terrified of your own children, since they are natives in a world where you will always be immigrants. because you fear them, you entrust your bureaucracies with the parental responsibilities you are too cowardly to confront yourselves. in our world, all the sentiments and expressions of humanity, from the debasing to the angelic, are parts of a seamless whole, the global conversation of bits. we cannot separate the air that chokes from the air upon which wings beat.
in china, germany, france, russia, singapore, italy and the united states, you are trying to ward off the virus of liberty by erecting guard posts at the frontiers of cyberspace. these may keep out the contagion for a small time, but they will not work in a world that will soon be blanketed in bit-bearing media.
your increasingly obsolete information industries would perpetuate themselves by proposing laws, in america and elsewhere, that claim to own speech itself throughout the world. these laws would declare ideas to be another industrial product, no more noble than pig iron. in our world, whatever the human mind may create can be reproduced and distributed infinitely at no cost. the global conveyance of thought no longer requires your factories to accomplish.
these increasingly hostile and colonial measures place us in the same position as those previous lovers of freedom and self-determination who had to reject the authorities of distant, uninformed powers. we must declare our virtual selves immune to your sovereignty, even as we continue to consent to your rule over our bodies. we will spread ourselves across the planet so that no one can arrest our thoughts.
we will create a civilization of the mind in cyberspace. may it be more humane and fair than the world your governments have made before.
flag is mrctf vigenere crypto crack man, please add underscore and curly braces.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">mrctf&#123;vigenere_crypto_crack_man&#125;
flag&#123;vigenere_crypto_crack_man&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<h2 id="维吉尼亚密码-AFCTF2018-Vigenere"><a href="#维吉尼亚密码-AFCTF2018-Vigenere" class="headerlink" title="维吉尼亚密码-[AFCTF2018]Vigenère"></a>维吉尼亚密码-[AFCTF2018]Vigenère</h2><p><img src="/2020/11/25/BUUOJ-crypto/image-20210504220959911.png" alt="image-20210504220959911"></p>
<p>还是直接在线解，哎，挺无聊的。。。</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">When in the Course of human events it becomes necessary for one people to dissolve the political bands which have connected them with another and to assume among the powers of the earth, the separate and equal station to which the Laws of Nature and of Nature&#39;s God entitle them, a decent respect to the opinions of mankind requires that they should declare the causes which impel them to the separation.

We hold these truths to be self-evident, that all men are created equal, that they are endowed by their Creator with certain unalienable Rights, that among these are Life, Liberty and the pursuit of Happiness. — That to secure these rights, Governments are instituted among Men, deriving their just powers from the consent of the governed, — That whenever any Form of Government becomes destructive of these ends, it is the Right of the People to alter or to abolish it, and to institute new Government, laying its foundation on such principles and organizing its powers in such form, as to them shall seem most likely to effect their Safety and Happiness. Prudence, indeed, will dictate that Governments long established should not be changed for light and transient causes; and accordingly all experience hath shewn that mankind are more disposed to suffer, while evils are sufferable than to right themselves by abolishing the forms to which they are accustomed. But when a long train of abuses and usurpations, pursuing invariably the same Object evinces a design to reduce them under absolute Despotism, it is their right, it is their duty, to throw off such Government, and to provide new Guards for their future security. — Such has been the patient sufferance of these Colonies; and such is now the necessity which constrains them to alter their former Systems of Government. The history of the present King of Great Britain is a history of repeated injuries and usurpations, all having in direct object the establishment of an absolute Tyranny over these States. To prove this, let Facts be submitted to a candid world.

He has refused his Assent to Laws, the most wholesome and necessary for the public good.

He has forbidden his Governors to pass Laws of immediate and pressing importance, unless suspended in their operation till his Assent should be obtained; and when so suspended, he has utterly neglected to attend to them.

He has refused to pass other Laws for the accommodation of large districts of people, unless those people would relinquish the right of Representation in the Legislature, a right inestimable to them and formidable to tyrants only.

He has called together legislative bodies at places unusual, uncomfortable, and distant from the depository of their Public Records, for the sole purpose of fatiguing them into compliance with his measures.

He has dissolved Representative Houses repeatedly, for opposing with manly firmness his invasions on the rights of the people.

He has refused for a long time, after such dissolutions, to cause others to be elected, whereby the Legislative Powers, incapable of Annihilation, have returned to the People at large for their exercise; the State remaining in the mean time exposed to all the dangers of invasion from without, and convulsions within.

He has endeavoured to prevent the population of these States; for that purpose obstructing the Laws for Naturalization of Foreigners; refusing to pass others to encourage their migrations hither, and raising the conditions of new Appropriations of Lands.

He has obstructed the Administration of Justice by refusing his Assent to Laws for establishing Judiciary Powers.

He has made Judges dependent on his Will alone for the tenure of their offices, and the amount and payment of their salaries.

flag is afctf&#123;Whooooooo_U_Gotcha!&#125;

He has erected a multitude of New Offices, and sent hither swarms of Officers to harass our people and eat out their substance.

He has kept among us, in times of peace, Standing Armies without the Consent of our legislatures.

He has affected to render the Military independent of and superior to the Civil Power.

He has combined with others to subject us to a jurisdiction foreign to our constitution, and unacknowledged by our laws; giving his Assent to their Acts of pretended Legislation:

For quartering large bodies of armed troops among us:

For protecting them, by a mock Trial from punishment for any Murders which they should commit on the Inhabitants of these States:

For cutting off our Trade with all parts of the world:

For imposing Taxes on us without our Consent:

For depriving us in many cases, of the benefit of Trial by Jury:

For transporting us beyond Seas to be tried for pretended offences:

For abolishing the free System of English Laws in a neighbouring Province, establishing therein an Arbitrary government, and enlarging its Boundaries so as to render it at once an example and fit instrument for introducing the same absolute rule into these Colonies

For taking away our Charters, abolishing our most valuable Laws and altering fundamentally the Forms of our Governments:

For suspending our own Legislatures, and declaring themselves invested with power to legislate for us in all cases whatsoever.

He has abdicated Government here, by declaring us out of his Protection and waging War against us.

He has plundered our seas, ravaged our coasts, burnt our towns, and destroyed the lives of our people.

He is at this time transporting large Armies of foreign Mercenaries to compleat the works of death, desolation, and tyranny, already begun with circumstances of Cruelty &amp; Perfidy scarcely paralleled in the most barbarous ages, and totally unworthy the Head of a civilized nation.

He has constrained our fellow Citizens taken Captive on the high Seas to bear Arms against their Country, to become the executioners of their friends and Brethren, or to fall themselves by their Hands.

He has excited domestic insurrections amongst us, and has endeavoured to bring on the inhabitants of our frontiers, the merciless Indian Savages whose known rule of warfare, is an undistinguished destruction of all ages, sexes and conditions.

In every stage of these Oppressions We have Petitioned for Redress in the most humble terms: Our repeated Petitions have been answered only by repeated injury. A Prince, whose character is thus marked by every act which may define a Tyrant, is unfit to be the ruler of a free people.

Nor have We been wanting in attentions to our British brethren. We have warned them from time to time of attempts by their legislature to extend an unwarrantable jurisdiction over us. We have reminded them of the circumstances of our emigration and settlement here. We have appealed to their native justice and magnanimity, and we have conjured them by the ties of our common kindred to disavow these usurpations, which would inevitably interrupt our connections and correspondence. They too have been deaf to the voice of justice and of consanguinity. We must, therefore, acquiesce in the necessity, which denounces our Separation, and hold them, as we hold the rest of mankind, Enemies in War, in Peace Friends.

We, therefore, the Representatives of the united States of America, in General Congress, Assembled, appealing to the Supreme Judge of the world for the rectitude of our intentions, do, in the Name, and by Authority of the good People of these Colonies, solemnly publish and declare, That these united Colonies are, and of Right ought to be Free and Independent States, that they are Absolved from all Allegiance to the British Crown, and that all political connection between them and the State of Great Britain, is and ought to be totally dissolved; and that as Free and Independent States, they have full Power to levy War, conclude Peace, contract Alliances, establish Commerce, and to do all other Acts and Things which Independent States may of right do. — And for the support of this Declaration, with a firm reliance on the protection of Divine Providence, we mutually pledge to each other our Lives, our Fortunes, and our sacred Honor.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="模运算"><a href="#模运算" class="headerlink" title="模运算"></a>模运算</h1><h2 id="1-模运算-小学生的密码学"><a href="#1-模运算-小学生的密码学" class="headerlink" title="1.模运算-小学生的密码学"></a>1.模运算-小学生的密码学</h2><p>仿射密码解密脚本<br><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#@author:M4xlmum</span>
<span class="token triple-quoted-string string">'''
表达式:e(x)=11x+6(mod26)
密文：welcylk
'''</span>
<span class="token keyword">import</span> gmpy2

<span class="token comment">#再用到时改下参数即可</span>
a <span class="token operator">=</span> <span class="token number">11</span>
b <span class="token operator">=</span> <span class="token number">6</span>

mul <span class="token operator">=</span> <span class="token number">0</span>
<span class="token comment">#求乘法逆元</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">*</span> a<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">26</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        mul <span class="token operator">=</span> i
        <span class="token keyword">break</span>

<span class="token comment">#求加法逆元</span>
add <span class="token operator">=</span> <span class="token number">26</span> <span class="token operator">-</span> b
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"乘法逆元为:"</span><span class="token punctuation">,</span> mul<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"加法逆元为:"</span><span class="token punctuation">,</span> add<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">'''
解密算法即为:d(x) = (x + add) * mul
d(x) = (x+20) * 19
'''</span>
m <span class="token operator">=</span> <span class="token string">"welcylk"</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">97</span><span class="token operator">+</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">19</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">26</span><span class="token operator">+</span><span class="token number">97</span><span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n仿射解密完成"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><code>sorcery</code><br><code>flag&#123;c29yY2VyeQ==&#125;</code></p>
<h1 id="字频分析"><a href="#字频分析" class="headerlink" title="字频分析"></a>字频分析</h1><h2 id="1-词频分析-BJDCTF-2nd-Y1nglish-y1ng"><a href="#1-词频分析-BJDCTF-2nd-Y1nglish-y1ng" class="headerlink" title="1.词频分析-[BJDCTF 2nd]Y1nglish-y1ng"></a>1.词频分析-[BJDCTF 2nd]Y1nglish-y1ng</h2><blockquote>
<p>给了个文本，这种就是字母硬替换（随即替换，没有一点规律），一般情况下，除非给出密码表，否则很难解密。但是好在还是有方法，因为英文字母的出现次数的多或少，可以按照字频解密，这里用一个在线网站解密<br><a target="_blank" rel="noopener" href="https://quipqiup.com/">quipquip</a><br><img src="/2020/11/25/BUUOJ-crypto/1.png" alt><br><code>BJD &#123;pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4cy&#125;</code>、<code>flag&#123;pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4cy&#125;</code>，<em>_</em>，<code>flag&#123;pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck&#125;</code></p>
</blockquote>
<h2 id="2-词频分析-世上无难事"><a href="#2-词频分析-世上无难事" class="headerlink" title="2.词频分析-世上无难事"></a>2.词频分析-世上无难事</h2><p>词频分析</p>
<pre class="line-numbers language-none"><code class="language-none">HELLO EVERYBODY THANK YOU ALL RIGHT EVERYBODY GO AHEAD AND HAVE A SEAT HOW IS EVERYBODY DOING TODAY HOW ABOUT TIM SPICER WE ARE HERE WITH STUDENTS AT WAKEFIELD HIGH SCHOOL IN ARLINGTON VIRGINIA AND WE HAVE GOT STUDENTS TUNING IN FROM ALL ACROSS AMERICA FROM KINDERGARTEN THROUGH 12TH GRADE AND WE ARE JUST SO GLAD THAT ALL COULD JOIN US TODAY AND WE WANT TO THANK WAKEFIELD FOR BEING SUCH AN OUTSTANDING HOST GIVE YOURSELVES A BIG ROUND OF APPLAUSE AND THE KEY IS 640E11012805F211B0AB24FF02A1ED09<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><code>640E11012805F211B0AB24FF02A1ED09</code>题目说要小写，转换<code>flag&#123;640e11012805f211b0ab24ff02a1ed09&#125;</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string

data <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请输入大写:"</span><span class="token punctuation">)</span>
res <span class="token operator">=</span> <span class="token string">''</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> data<span class="token punctuation">:</span>
    <span class="token keyword">if</span> i <span class="token keyword">in</span> string<span class="token punctuation">.</span>ascii_uppercase<span class="token punctuation">:</span>
        res <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        res <span class="token operator">+=</span> i

<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="其他密码"><a href="#其他密码" class="headerlink" title="其他密码"></a>其他密码</h1><h2 id="1-文件异或-异性相吸"><a href="#1-文件异或-异性相吸" class="headerlink" title="1.文件异或-异性相吸"></a>1.文件异或-异性相吸</h2><p>文件异或，看属性都是38个字节，就把文件内容按位异或取结果，脚本<br><pre class="line-numbers language-python" data-language="python"><code class="language-python">flag <span class="token operator">=</span> <span class="token string">''</span>
mfile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r"C:\Users\Administrator\Desktop\ctf题目\buuoh\crypto\异性相吸\mfile.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
key <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r"C:\Users\Administrator\Desktop\ctf题目\buuoh\crypto\异性相吸\key.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>mfile<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<p><code>flag&#123;ea1bc0988992276b7f95b54a7435e89e&#125;</code></p>
<h2 id="2-文件异或-yxx"><a href="#2-文件异或-yxx" class="headerlink" title="2.文件异或-yxx"></a>2.文件异或-yxx</h2><p>跟上面的思路是一样的，直接文件内容异或，特点是<code>两个文件的字节数相同</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'明文.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f1<span class="token punctuation">,</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'密文.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f2<span class="token punctuation">:</span>
    c1<span class="token punctuation">,</span> c2 <span class="token operator">=</span> f1<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> f2<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">)</span>
    flag <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>c1<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> c2<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>


<span class="token triple-quoted-string string">"""
32 32
flag:nctf&#123;xor_xor_xor_biubiubiu&#125;
flag&#123;xor_xor_xor_biubiubiu&#125;
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="3-md5爆破-还原大师"><a href="#3-md5爆破-还原大师" class="headerlink" title="3.md5爆破-还原大师"></a>3.md5爆破-还原大师</h2><pre class="line-numbers language-none"><code class="language-none">我们得到了一串神秘字符串：TASC?O3RJMV?WDJKX?ZM,问号部分是未知大写字母，为了确定这个神秘字符串，我们通过了其他途径获得了这个字串的32位MD5码。但是我们获得它的32位MD5码也是残缺不全，E903???4DAB????08?????51?80??8A?,请猜出神秘字符串的原本模样，并且提交这个字串的32位MD5码作为答案。<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> string

data <span class="token operator">=</span> <span class="token string">"TASC&#123;&#125;O3RJMV&#123;&#125;WDJKX&#123;&#125;ZM"</span>

brute_upper <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_uppercase

<span class="token keyword">for</span> i <span class="token keyword">in</span> brute_upper<span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> brute_upper<span class="token punctuation">:</span>
        <span class="token keyword">for</span> k <span class="token keyword">in</span> brute_upper<span class="token punctuation">:</span>
            tmp <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> tmp<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"E903"</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"res="</span><span class="token punctuation">,</span> tmp<span class="token punctuation">)</span>


<span class="token comment">#TASCJO3RJMVKWDJKXLZM</span>
<span class="token comment">#res=E9032994DABAC08080091151380478A2</span>
<span class="token triple-quoted-string string">'''
print(hashlib.md5(data.encode("UTF-8")).hexdigest().upper())
'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>flag&#123;E9032994DABAC08080091151380478A2&#125;</code></p>
<h2 id="海明码、奇偶校验码-鸡藕椒盐味"><a href="#海明码、奇偶校验码-鸡藕椒盐味" class="headerlink" title="海明码、奇偶校验码-鸡藕椒盐味"></a>海明码、奇偶校验码-鸡藕椒盐味</h2><p>找个python写的海明码实现的例子如下</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> math
 
userin <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"请输入海明码:"</span><span class="token punctuation">)</span>
haiming<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">#输入的海明码是字符串，下面的代码是将字符串转化成整型列表</span>
haiming<span class="token operator">=</span><span class="token builtin">list</span><span class="token punctuation">(</span>haiming<span class="token punctuation">)</span>
<span class="token keyword">for</span> x <span class="token keyword">in</span> userin<span class="token punctuation">:</span>
	haiming<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>
 
<span class="token comment">#计算校验码的个数</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>haiming<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> <span class="token number">2</span><span class="token operator">**</span>i<span class="token operator">></span><span class="token builtin">len</span><span class="token punctuation">(</span>haiming<span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">break</span>
<span class="token comment">#校验码个数</span>
num <span class="token operator">=</span> i
<span class="token comment">#标记错位</span>
flag <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
	b<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>i<span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token comment">#利用python的步长。</span>
		a <span class="token operator">=</span> haiming<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>haiming<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
			flag <span class="token operator">=</span> flag <span class="token operator">+</span> <span class="token number">2</span><span class="token operator">**</span>i
		<span class="token keyword">print</span> <span class="token punctuation">(</span>a<span class="token punctuation">)</span>
	<span class="token keyword">else</span><span class="token punctuation">:</span>
		<span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span>i<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>haiming<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token punctuation">(</span>j<span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
				<span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span>j<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
					<span class="token keyword">if</span><span class="token punctuation">(</span>k<span class="token operator">></span><span class="token builtin">len</span><span class="token punctuation">(</span>haiming<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
						<span class="token keyword">break</span>
					b<span class="token punctuation">.</span>append<span class="token punctuation">(</span>haiming<span class="token punctuation">[</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">2</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
			flag <span class="token operator">=</span> flag<span class="token operator">+</span><span class="token number">2</span><span class="token operator">**</span>i
		<span class="token keyword">print</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span>
	<span class="token keyword">del</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token keyword">if</span> flag <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> haiming<span class="token punctuation">[</span>flag<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">:</span>
                haiming<span class="token punctuation">[</span>flag<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">1</span>
        <span class="token keyword">elif</span> haiming<span class="token punctuation">[</span>flag<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>
                haiming<span class="token punctuation">[</span>flag<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token number">0</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"第%d位出错"</span> <span class="token operator">%</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span>haiming<span class="token punctuation">)</span>
<span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token string">"没有错误"</span><span class="token punctuation">)</span>        
<span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">"Press &lt;enter>"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>提示倒了一下序，原来的数据应该是</p>
<pre class="line-numbers language-data" data-language="data"><code class="language-data">000001010011<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210504234104663.png" alt="看到第9位出现错误，给他纠正回来"></p>
<pre class="line-numbers language-data" data-language="data"><code class="language-data">000001011011<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210504234218752.png" alt="没错了"></p>
<p>再将数据倒数后进行md5哈希一下</p>
<pre class="line-numbers language-data" data-language="data"><code class="language-data">110110100000

查询结果：
md5(110110100000,32) &#x3D; d14084c7ceca6359eaac6df3c234dd3b
md5(110110100000,16) &#x3D; ceca6359eaac6df3
flag&#123;d14084c7ceca6359eaac6df3c234dd3b&#125;





# RSA



## 1.RSA基础-[HDCTF2019]basic rsa

知识点:
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>pow(a, b, c) = a ^ b % c<br><pre class="line-numbers language-none"><code class="language-none">
​&#96;&#96;&#96;python
&quot;&quot;&quot;
import gmpy2
from Cryptodome.Util.number import *
from binascii import a2b_hex, b2a_hex

flag &#x3D; &quot;*********************&quot;

p &#x3D; 262248800182277040650192055439906580479
q &#x3D; 262854994239322828547925595487519915551

e &#x3D; 65533
n &#x3D; p * q


c &#x3D; pow(int(b2a_hex(flag), 16), e, n)

print(c)

# 27565231154623519221597938803435789010285480123476977081867877272451638645710
&quot;&quot;&quot;
import gmpy2
import libnum
from Cryptodome.Util.number import *
from binascii import a2b_hex, b2a_hex

flag &#x3D; &quot;flag&#123;fake_flag&#125;&quot;

p &#x3D; 262248800182277040650192055439906580479
q &#x3D; 262854994239322828547925595487519915551
e &#x3D; 65533
n &#x3D; p * q

c &#x3D; pow(int(b2a_hex(flag.encode()), 16), e, n)  # c &#x3D; m ^ e mod n
print(c)
# 27565231154623519221597938803435789010285480123476977081867877272451638645710

# 解密算法为m &#x3D; c ^ d mod n
c &#x3D; 27565231154623519221597938803435789010285480123476977081867877272451638645710
phi &#x3D; (p-1) * (q-1)
d &#x3D; gmpy2.invert(e, phi)  # e * d &#x3D; 1 (mod phi) 求模逆
d &#x3D; int(d)
m &#x3D; pow(c, d, n)
flag &#x3D; libnum.n2s(m)
print(flag)


# b&#39;flag&#123;B4by_Rs4&#125;&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p>
<p>flag为<code>flag&#123;B4by_Rs4&#125;</code></p>
<h1 id="RSA"><a href="#RSA" class="headerlink" title="RSA"></a>RSA</h1><h2 id="2-RSA基础-GUET-CTF2019-BabyRSA"><a href="#2-RSA基础-GUET-CTF2019-BabyRSA" class="headerlink" title="2.RSA基础-[GUET-CTF2019]BabyRSA"></a>2.RSA基础-[GUET-CTF2019]BabyRSA</h2><p>很简单的rsa，给出了太多，感觉不给p+q也能出啊。p+q或者e给哪个都能出的。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token triple-quoted-string string">"""
p+q : 0x1232fecb92adead91613e7d9ae5e36fe6bb765317d6ed38ad890b4073539a6231a6620584cea5730b5af83a3e80cf30141282c97be4400e33307573af6b25e2ea
(p+1)(q+1) : 0x5248becef1d925d45705a7302700d6a0ffe5877fddf9451a9c1181c4d82365806085fd86fbaab08b6fc66a967b2566d743c626547203b34ea3fdb1bc06dd3bb765fd8b919e3bd2cb15bc175c9498f9d9a0e216c2dde64d81255fa4c05a1ee619fc1fc505285a239e7bc655ec6605d9693078b800ee80931a7a0c84f33c851740
e : 0xe6b1bee47bd63f615c7d0a43c529d219
d : 0x2dde7fbaed477f6d62838d55b0d0964868cf6efb2c282a5f13e6008ce7317a24cb57aec49ef0d738919f47cdcd9677cd52ac2293ec5938aa198f962678b5cd0da344453f521a69b2ac03647cdd8339f4e38cec452d54e60698833d67f9315c02ddaa4c79ebaa902c605d7bda32ce970541b2d9a17d62b52df813b2fb0c5ab1a5
enc_flag : 0x50ae00623211ba6089ddfae21e204ab616f6c9d294e913550af3d66e85d0c0693ed53ed55c46d8cca1d7c2ad44839030df26b70f22a8567171a759b76fe5f07b3c5a6ec89117ed0a36c0950956b9cde880c575737f779143f921d745ac3bb0e379c05d9a3cc6bf0bea8aa91e4d5e752c7eb46b2e023edbc07d24a7c460a34a9a

n = p * q
(p+1)*(q+1) = p*q + p + q + 1
n = p*q = (p+1)*(q+1) - (p + q) - 1


# 开始想歪了，其实下面的没用
d * e = 1 mod phi
(p-1)*(q-1) = p*q - p - q + 1 = phi
"""</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum


<span class="token comment"># 假设pq = p+q、p1q1 = (p-1)*(q-1)</span>
pq <span class="token operator">=</span> <span class="token number">0x1232fecb92adead91613e7d9ae5e36fe6bb765317d6ed38ad890b4073539a6231a6620584cea5730b5af83a3e80cf30141282c97be4400e33307573af6b25e2ea</span>
p1q1 <span class="token operator">=</span> <span class="token number">0x5248becef1d925d45705a7302700d6a0ffe5877fddf9451a9c1181c4d82365806085fd86fbaab08b6fc66a967b2566d743c626547203b34ea3fdb1bc06dd3bb765fd8b919e3bd2cb15bc175c9498f9d9a0e216c2dde64d81255fa4c05a1ee619fc1fc505285a239e7bc655ec6605d9693078b800ee80931a7a0c84f33c851740</span>
e <span class="token operator">=</span> <span class="token number">0xe6b1bee47bd63f615c7d0a43c529d219</span>
d <span class="token operator">=</span> <span class="token number">0x2dde7fbaed477f6d62838d55b0d0964868cf6efb2c282a5f13e6008ce7317a24cb57aec49ef0d738919f47cdcd9677cd52ac2293ec5938aa198f962678b5cd0da344453f521a69b2ac03647cdd8339f4e38cec452d54e60698833d67f9315c02ddaa4c79ebaa902c605d7bda32ce970541b2d9a17d62b52df813b2fb0c5ab1a5</span>
enc_flag <span class="token operator">=</span> <span class="token number">0x50ae00623211ba6089ddfae21e204ab616f6c9d294e913550af3d66e85d0c0693ed53ed55c46d8cca1d7c2ad44839030df26b70f22a8567171a759b76fe5f07b3c5a6ec89117ed0a36c0950956b9cde880c575737f779143f921d745ac3bb0e379c05d9a3cc6bf0bea8aa91e4d5e752c7eb46b2e023edbc07d24a7c460a34a9a</span>

n <span class="token operator">=</span> p1q1 <span class="token operator">-</span> pq <span class="token operator">-</span> <span class="token number">1</span>


ans <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>enc_flag<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>ans<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># b'flag&#123;cc7490e-78ab-11e9-b422-8ba97e5da1fd&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;cc7490e-78ab-11e9-b422-8ba97e5da1fd&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="3-RSA基础-ACTF新生赛2020-crypto-rsa0"><a href="#3-RSA基础-ACTF新生赛2020-crypto-rsa0" class="headerlink" title="3.RSA基础-[ACTF新生赛2020]crypto-rsa0"></a>3.RSA基础-[ACTF新生赛2020]crypto-rsa0</h2><p>先解个zip的伪加密，有点misc的感觉了</p>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210504173811552.png" alt="image-20210504173811552"></p>
<p>09改成00就OK了，后面就是正常的rsa了</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Cryptodome<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> random
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum

<span class="token comment"># FLAG = 'test'  # hidden, please solve it</span>


<span class="token comment"># flag = int.from_bytes(FLAG, byteorder='big')</span>
<span class="token comment"># flag = 123</span>
<span class="token triple-quoted-string string">"""
p=getPrime(512)
q=getPrime(512)

print(p)
print(q)
"""</span>
enc <span class="token operator">=</span> <span class="token number">50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350</span>
p <span class="token operator">=</span> <span class="token number">9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411</span>
q <span class="token operator">=</span> <span class="token number">7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223</span>
N <span class="token operator">=</span> p <span class="token operator">*</span> q
e <span class="token operator">=</span> <span class="token number">65537</span>
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>

m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>enc<span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
ci <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ci<span class="token punctuation">)</span>
<span class="token triple-quoted-string string">"""
enc = pow(flag, e, N)
print(enc)
"""</span>
<span class="token triple-quoted-string string">"""
9018588066434206377240277162476739271386240173088676526295315163990968347022922841299128274551482926490908399237153883494964743436193853978459947060210411
7547005673877738257835729760037765213340036696350766324229143613179932145122130685778504062410137043635958208805698698169847293520149572605026492751740223
50996206925961019415256003394743594106061473865032792073035954925875056079762626648452348856255575840166640519334862690063949316515750256545937498213476286637455803452890781264446030732369871044870359838568618176586206041055000297981733272816089806014400846392307742065559331874972274844992047849472203390350
"""</span>
<span class="token comment"># b'actf&#123;n0w_y0u_see_RSA&#125;'</span>
<span class="token comment"># flag&#123;n0w_y0u_see_RSA&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSA基础-AFCTF2018-你能看出这是什么加密么"><a href="#RSA基础-AFCTF2018-你能看出这是什么加密么" class="headerlink" title="RSA基础-[AFCTF2018]你能看出这是什么加密么"></a>RSA基础-[AFCTF2018]你能看出这是什么加密么</h2><p>这…一看就知道是RSA啊，感觉我号弱智，也许是18年的题的问题，那时候的题还不难也许。也可能是发展太快了，现在的技术用来解以前的难题变得简单了。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum


p <span class="token operator">=</span> <span class="token number">0x928fb6aa9d813b6c3270131818a7c54edb18e3806942b88670106c1821e0326364194a8c49392849432b37632f0abe3f3c52e909b939c91c50e41a7b8cd00c67d6743b4f</span>
q <span class="token operator">=</span> <span class="token number">0xec301417ccdffa679a8dcc4027dd0d75baf9d441625ed8930472165717f4732884c33f25d4ee6a6c9ae6c44aedad039b0b72cf42cab7f80d32b74061</span>
e <span class="token operator">=</span> <span class="token number">0x10001</span>
c <span class="token operator">=</span> <span class="token number">0x70c9133e1647e95c3cb99bd998a9028b5bf492929725a9e8e6d2e277fa0f37205580b196e5f121a2e83bc80a8204c99f5036a07c8cf6f96c420369b4161d2654a7eccbdaf583204b645e137b3bd15c5ce865298416fd5831cba0d947113ed5be5426b708b89451934d11f9aed9085b48b729449e461ff0863552149b965e22b6</span>

n <span class="token operator">=</span> p <span class="token operator">*</span> q
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># flag在输出内容的最后为</span>
<span class="token comment"># afctf&#123;R54_|5_$0_$imp13&#125;</span>
<span class="token comment"># flag&#123;R54_|5_$0_$imp13&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSA基础-ACTF新生赛2020-crypto-rsa3"><a href="#RSA基础-ACTF新生赛2020-crypto-rsa3" class="headerlink" title="RSA基础-[ACTF新生赛2020]crypto-rsa3"></a>RSA基础-[ACTF新生赛2020]crypto-rsa3</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Cryptodome<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum
<span class="token triple-quoted-string string">"""
e = 65537
p = getPrime(512)
q = int(gmpy2.next_prime(p))
n = p * q
m = bytes_to_long(FLAG)
c = pow(m, e, n)
print(n)
print(c)
"""</span>
<span class="token comment"># 可以自己写算法解，但没必要，直接上工具网站求p即可</span>
e <span class="token operator">=</span> <span class="token number">65537</span>
n <span class="token operator">=</span> <span class="token number">177606504836499246970959030226871608885969321778211051080524634084516973331441644993898029573612290095853069264036530459253652875586267946877831055147546910227100566496658148381834683037366134553848011903251252726474047661274223137727688689535823533046778793131902143444408735610821167838717488859902242863683</span>
c <span class="token operator">=</span> <span class="token number">1457390378511382354771000540945361168984775052693073641682375071407490851289703070905749525830483035988737117653971428424612332020925926617395558868160380601912498299922825914229510166957910451841730028919883807634489834128830801407228447221775264711349928156290102782374379406719292116047581560530382210049</span>
p <span class="token operator">=</span> <span class="token number">13326909050357447643526585836833969378078147057723054701432842192988717649385731430095055622303549577233495793715580004801634268505725255565021519817179231</span>
q <span class="token operator">=</span> n <span class="token operator">//</span> p
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>


<span class="token comment"># b'actf&#123;p_and_q_should_not_be_so_close_in_value&#125;'</span>
<span class="token comment"># flag&#123;p_and_q_should_not_be_so_close_in_value&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSA基础-BJDCTF2020-easyrsa"><a href="#RSA基础-BJDCTF2020-easyrsa" class="headerlink" title="RSA基础-[BJDCTF2020]easyrsa"></a>RSA基础-[BJDCTF2020]easyrsa</h2><p>有个不是特别麻烦的算法，不分析了，直接在线解了n</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Cryptodome<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> bytes_to_long
<span class="token keyword">from</span> sympy <span class="token keyword">import</span> Derivative
<span class="token keyword">from</span> fractions <span class="token keyword">import</span> Fraction
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum

<span class="token triple-quoted-string string">"""
p = getPrime(1024)
q = getPrime(1024)
e = 65537
n = p * q
z = Fraction(1, Derivative(arctan(p), p)) - Fraction(1, Derivative(arth(q), q))
m = bytes_to_long(flag)
c = pow(m, e, n)
print(c, z, n)
"""</span>
<span class="token triple-quoted-string string">'''
output:
7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035
32115748677623209667471622872185275070257924766015020072805267359839059393284316595882933372289732127274076434587519333300142473010344694803885168557548801202495933226215437763329280242113556524498457559562872900811602056944423967403777623306961880757613246328729616643032628964072931272085866928045973799374711846825157781056965164178505232524245809179235607571567174228822561697888645968559343608375331988097157145264357626738141646556353500994924115875748198318036296898604097000938272195903056733565880150540275369239637793975923329598716003350308259321436752579291000355560431542229699759955141152914708362494482
15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441
'''</span>
n <span class="token operator">=</span> <span class="token number">15310745161336895413406690009324766200789179248896951942047235448901612351128459309145825547569298479821101249094161867207686537607047447968708758990950136380924747359052570549594098569970632854351825950729752563502284849263730127586382522703959893392329333760927637353052250274195821469023401443841395096410231843592101426591882573405934188675124326997277775238287928403743324297705151732524641213516306585297722190780088180705070359469719869343939106529204798285957516860774384001892777525916167743272419958572055332232056095979448155082465977781482598371994798871917514767508394730447974770329967681767625495394441</span>
p <span class="token operator">=</span> <span class="token number">105909195259921349656664570904199242969110902804477734660927330311460997899731622163728968380757294196277263615386525795293086103142131020215128282050307177125962302515483190468569376643751587606016315185736245896434947691528567696271911398179288329609207435393579332931583829355558784305002360873458907029141</span>
q <span class="token operator">=</span> n <span class="token operator">//</span> p
c <span class="token operator">=</span> <span class="token number">7922547866857761459807491502654216283012776177789511549350672958101810281348402284098310147796549430689253803510994877420135537268549410652654479620858691324110367182025648788407041599943091386227543182157746202947099572389676084392706406084307657000104665696654409155006313203957292885743791715198781974205578654792123191584957665293208390453748369182333152809882312453359706147808198922916762773721726681588977103877454119043744889164529383188077499194932909643918696646876907327364751380953182517883134591810800848971719184808713694342985458103006676013451912221080252735948993692674899399826084848622145815461035</span>
e <span class="token operator">=</span> <span class="token number">65537</span>
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># b'BJD&#123;Advanced_mathematics_is_too_hard!!!&#125;'</span>
<span class="token comment"># flag&#123;Advanced_mathematics_is_too_hard!!!&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSA文件分解公钥信息-AFCTF2018-可怜的RSA"><a href="#RSA文件分解公钥信息-AFCTF2018-可怜的RSA" class="headerlink" title="RSA文件分解公钥信息-[AFCTF2018]可怜的RSA"></a>RSA文件分解公钥信息-[AFCTF2018]可怜的RSA</h2><p>对文件内容解密需用到最下面的东西，具体原因没深想。。。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">from</span> Cryptodome<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">from</span> Cryptodome<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> PKCS1_OAEP
<span class="token keyword">import</span> factordb<span class="token punctuation">.</span>factordb <span class="token keyword">as</span> factor
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> gmpy2


f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"public.key"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
pub <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
n<span class="token punctuation">,</span> e <span class="token operator">=</span> pub<span class="token punctuation">.</span>n<span class="token punctuation">,</span> pub<span class="token punctuation">.</span>e

response <span class="token operator">=</span> factor<span class="token punctuation">.</span>FactorDB<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
p<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>response<span class="token punctuation">[</span><span class="token string">'factors'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>response<span class="token punctuation">[</span><span class="token string">'factors'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>


<span class="token triple-quoted-string string">"""
似乎要用下面封装好的对flag.enc文件内容进行解密，具体原因尚待考究。
"""</span>
key_info <span class="token operator">=</span> RSA<span class="token punctuation">.</span>construct<span class="token punctuation">(</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span>

key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>importKey<span class="token punctuation">(</span>key_info<span class="token punctuation">.</span>exportKey<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

key <span class="token operator">=</span> PKCS1_OAEP<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">)</span>

f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.enc'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
flag <span class="token operator">=</span> key<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># b'afctf&#123;R54_|5_$0_B0rin9&#125;'</span>
<span class="token comment"># flag&#123;R54_|5_$0_B0rin9&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSA大整数分解-RoarCTF2019-RSA"><a href="#RSA大整数分解-RoarCTF2019-RSA" class="headerlink" title="RSA大整数分解-[RoarCTF2019]RSA"></a>RSA大整数分解-[RoarCTF2019]RSA</h2><p>本来是需要进行解方程计算x，y应该也许，但是那个z也不知道干啥出来的，所以我选择在线分解</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum


<span class="token triple-quoted-string string">"""
A = (((y % x) ** 5) % (x % y)) ** 2019 + y ** 316 + (y + 1) / x
p = next_prime(z * x * y)
q = next_prime(z)
A = 2683349182678714524247469512793476009861014781004924905484127480308161377768192868061561886577048646432382128960881487463427414176114486885830693959404989743229103516924432512724195654425703453612710310587164417035878308390676612592848750287387318129424195208623440294647817367740878211949147526287091298307480502897462279102572556822231669438279317474828479089719046386411971105448723910594710418093977044179949800373224354729179833393219827789389078869290217569511230868967647963089430594258815146362187250855166897553056073744582946148472068334167445499314471518357535261186318756327890016183228412253724
"""</span>
n <span class="token operator">=</span> <span class="token number">117930806043507374325982291823027285148807239117987369609583515353889814856088099671454394340816761242974462268435911765045576377767711593100416932019831889059333166946263184861287975722954992219766493089630810876984781113645362450398009234556085330943125568377741065242183073882558834603430862598066786475299918395341014877416901185392905676043795425126968745185649565106322336954427505104906770493155723995382318346714944184577894150229037758434597242564815299174950147754426950251419204917376517360505024549691723683358170823416757973059354784142601436519500811159036795034676360028928301979780528294114933347127</span>
c <span class="token operator">=</span> <span class="token number">41971850275428383625653350824107291609587853887037624239544762751558838294718672159979929266922528917912189124713273673948051464226519605803745171340724343705832198554680196798623263806617998072496026019940476324971696928551159371970207365741517064295956376809297272541800647747885170905737868568000101029143923792003486793278197051326716680212726111099439262589341050943913401067673851885114314709706016622157285023272496793595281054074260451116213815934843317894898883215362289599366101018081513215120728297131352439066930452281829446586562062242527329672575620261776042653626411730955819001674118193293313612128</span>
p <span class="token operator">=</span> <span class="token number">842868045681390934539739959201847552284980179958879667933078453950968566151662147267006293571765463137270594151138695778986165111380428806545593588078365331313084230014618714412959584843421586674162688321942889369912392031882620994944241987153078156389470370195514285850736541078623854327959382156753458569</span>
q <span class="token operator">=</span> n <span class="token operator">//</span> p
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> <span class="token number">65537</span>  <span class="token comment"># 猜测，因为一般出的都是e=65537的</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># RoarCTF&#123;wm-l1l1ll1l1l1l111ll&#125;</span>
<span class="token comment"># flag&#123;wm-l1l1ll1l1l1l111ll&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="4-RSA大整数分解-rsa2"><a href="#4-RSA大整数分解-rsa2" class="headerlink" title="4.RSA大整数分解-rsa2"></a>4.RSA大整数分解-rsa2</h2><p>给出了大整数N，直接上factordb求p、q，求出</p>
<pre class="line-numbers language-整数分解结果" data-language="整数分解结果"><code class="language-整数分解结果">p&#x3D;11273732364123571293429600400343309403733952146912318879993851141423284675797325272321856863528776914709992821287788339848962916204774010644058033316303937
q&#x3D;9046853915223503351787031888977627106934564043204783593118678181991596316582877057556463152579621699010610569526573031954779520781448550677767565207407183<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210503145409154.png" alt="image-20210503145409154"></p>
<p>这个在线的分解，首先要点进后面两个链接，然后点击有一个show的选项，就能看到分解后的p、q了。</p>
<p>然后求出私钥<code>d</code>，下面就是，注释掉的内容是尝试可以使用python的factordb库进行整数分解，也可以用yafu工具进行，不过一般没有必要，</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> factordb<span class="token punctuation">.</span>factordb <span class="token keyword">import</span> FactorDB


N <span class="token operator">=</span> <span class="token number">101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471</span>
e <span class="token operator">=</span> <span class="token number">46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085</span>
p <span class="token operator">=</span> <span class="token number">11273732364123571293429600400343309403733952146912318879993851141423284675797325272321856863528776914709992821287788339848962916204774010644058033316303937</span>
q <span class="token operator">=</span> <span class="token number">9046853915223503351787031888977627106934564043204783593118678181991596316582877057556463152579621699010610569526573031954779520781448550677767565207407183</span>
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>phi<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""
res = FactorDB(N).connect().json()
factors = res['factors']
p, q = map(int, (factors[0][0], factors[1][0]))
phi = (p-1) * (q-1)
print(phi)
"""</span>

d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token comment"># d = 8920758995414587152829426558580025657357328745839747693739591820283538307445</span>
<span class="token comment"># flag = "flag&#123;" + hashlib.md5(hex(d)).hexdigest() + "&#125;"</span>
<span class="token comment"># print(flag)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>求出d为<code>8920758995414587152829426558580025657357328745839747693739591820283538307445</code></p>
<p>然后就是这个是我用python38解的，但是题给的代码明显是用python2进行的，所以用了在线的环境解了</p>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210503152406168.png" alt="image-20210503152406168"></p>
<p>在线工具的地址为<a target="_blank" rel="noopener" href="https://code.y444.cn/python">代码在线运行</a>，非常地好用</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>
<span class="token keyword">import</span> sys
<span class="token keyword">if</span> sys<span class="token punctuation">.</span>version_info<span class="token punctuation">.</span>major <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> io
    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> io<span class="token punctuation">.</span>TextIOWrapper<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># 请不要删除上方代码，否则包含中文时无法运行</span>
<span class="token keyword">import</span> hashlib
d <span class="token operator">=</span> <span class="token number">8920758995414587152829426558580025657357328745839747693739591820283538307445</span>
flag <span class="token operator">=</span> <span class="token string">"flag&#123;"</span> <span class="token operator">+</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&#125;"</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;47bf28da384590448e0b0d23909a25a4&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<h2 id="5-RSA大整数分解-RSAROLL"><a href="#5-RSA大整数分解-RSAROLL" class="headerlink" title="5.RSA大整数分解-RSAROLL"></a>5.RSA大整数分解-RSAROLL</h2><p>下面是数据(密文)</p>
<p>给了n、e分别为<code>&#123;920139713,19&#125;</code><br>然后下面是数据(密文)</p>
<pre class="line-numbers language-none"><code class="language-none">704796792
752211152
274704164
18414022
368270835
483295235
263072905
459788476
483295235
459788476
663551792
475206804
459788476
428313374
475206804
459788476
425392137
704796792
458265677
341524652
483295235
534149509
425392137
428313374
425392137
341524652
458265677
263072905
483295235
828509797
341524652
425392137
475206804
428313374
483295235
475206804
459788476
306220148<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>给出了N和e</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;920139713,19&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>解出p、q，</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;920139713 &#x3D; 18443 * 49891&#125;
p, q &#x3D; 18443, 49891<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment">#-----------------------------------------------------.</span>
<span class="token comment"># @Author  : M4XLMUM                                  |</span>
<span class="token comment"># @website : http://a16n.github.io or http://a16ne.cn |</span>
<span class="token comment">#-----------------------------------------------------.</span>
<span class="token keyword">import</span> gmpy2

p <span class="token operator">=</span> <span class="token number">18443</span> 
q <span class="token operator">=</span> <span class="token number">49891</span>
e <span class="token operator">=</span> <span class="token number">19</span>
n <span class="token operator">=</span> <span class="token number">920139713</span>

phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>

<span class="token builtin">file</span> <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'C:\Users\Administrator\Desktop\ctf题目\buuoj\crypto\RSAROLL\RsaRoll\data.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span>
lines <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> line <span class="token keyword">in</span> lines<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>flag&#123;13212je2ue28fy71w8u87y31r78eu1e2&#125;</code></p>
<h2 id="6-WUSTCTF2020-babyrsa"><a href="#6-WUSTCTF2020-babyrsa" class="headerlink" title="6.[WUSTCTF2020]babyrsa"></a>6.[WUSTCTF2020]babyrsa</h2><p>在线分解大整数n即可，没什么好说的，上脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum

c <span class="token operator">=</span> <span class="token number">28767758880940662779934612526152562406674613203406706867456395986985664083182</span>
n <span class="token operator">=</span> <span class="token number">73069886771625642807435783661014062604264768481735145873508846925735521695159</span>
p <span class="token operator">=</span> <span class="token number">189239861511125143212536989589123569301</span>  <span class="token comment"># 上factordb.com解一下粘过来一个就行了</span>
e <span class="token operator">=</span> <span class="token number">65537</span>

q <span class="token operator">=</span> n <span class="token operator">//</span> p
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">"""
823989108254974202105161758566497786100048618619858843500160755662795645
b'wctf2020&#123;just_@_piece_0f_cak3&#125;'
flag&#123;just_@_piece_0f_cak3&#125;
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="低加密指数广播攻击-RSA4"><a href="#低加密指数广播攻击-RSA4" class="headerlink" title="低加密指数广播攻击-RSA4"></a>低加密指数广播攻击-RSA4</h2><p>首先要用到中国剩余定理，就是下面的形式可以计算求得x</p>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210504202243816.png" alt="image-20210504202243816"></p>
<p>这里的x与rsa中的m可以对应，n对应该式中的[3,5,7]，c^e对应这里面的[2,4,6]。。。有下面的脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">chinese_remainder</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token number">0</span>
    prod <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> a <span class="token operator">*</span> b<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

    <span class="token keyword">for</span> n_i<span class="token punctuation">,</span> a_i <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        p <span class="token operator">=</span> prod <span class="token operator">//</span> n_i
        <span class="token builtin">sum</span> <span class="token operator">+=</span> a_i <span class="token operator">*</span> sympy<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>p<span class="token punctuation">,</span> n_i<span class="token punctuation">)</span> <span class="token operator">*</span> p
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">sum</span> <span class="token operator">%</span> prod<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这里对应的解式为<img src="/2020/11/25/BUUOJ-crypto/image-20210504203213083.png" alt="image-20210504203213083"></p>
<p>写下面的解题脚本。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum
<span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span>
<span class="token keyword">import</span> sympy


<span class="token keyword">def</span> <span class="token function">get_nscs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># ns列表中存的是n的值</span>
    ns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    cs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'题目.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        content <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            tempdata <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>content<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">r'\n'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> tempdata <span class="token keyword">and</span> tempdata<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'N'</span><span class="token punctuation">:</span>
                ns<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tempdata<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> tempdata <span class="token keyword">and</span> tempdata<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'c'</span><span class="token punctuation">:</span>
                cs<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tempdata<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> ns<span class="token punctuation">,</span> cs


<span class="token keyword">def</span> <span class="token function">chinese_remainder</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token number">0</span>
    prod <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> a<span class="token punctuation">,</span> b<span class="token punctuation">:</span> a <span class="token operator">*</span> b<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

    <span class="token keyword">for</span> n_i<span class="token punctuation">,</span> a_i <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> a<span class="token punctuation">)</span><span class="token punctuation">:</span>
        p <span class="token operator">=</span> prod <span class="token operator">//</span> n_i
        <span class="token builtin">sum</span> <span class="token operator">+=</span> a_i <span class="token operator">*</span> sympy<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>p<span class="token punctuation">,</span> n_i<span class="token punctuation">)</span> <span class="token operator">*</span> p
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">sum</span> <span class="token operator">%</span> prod<span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    ns<span class="token punctuation">,</span> cs <span class="token operator">=</span> get_nscs<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>cs<span class="token punctuation">)</span>
    ns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ns<span class="token punctuation">)</span><span class="token punctuation">)</span>
    cs <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cs<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>cs<span class="token punctuation">)</span>
    m <span class="token operator">=</span> chinese_remainder<span class="token punctuation">(</span>ns<span class="token punctuation">,</span> cs<span class="token punctuation">)</span>
    m <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>



<span class="token triple-quoted-string string">"""
b'noxCTF&#123;D4mn_y0u_h4s74d_wh47_4_b100dy_b4s74rd!&#125;'
flag&#123;D4mn_y0u_h4s74d_wh47_4_b100dy_b4s74rd!&#125;
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>文件内的每个赋值最后要加个空格，我脚本的问题。</p>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210504220503296.png" alt="image-20210504220503296"></p>
<h2 id="7-RSA小公钥指数攻击-Dangerous-RSA"><a href="#7-RSA小公钥指数攻击-Dangerous-RSA" class="headerlink" title="7.RSA小公钥指数攻击-Dangerous RSA"></a>7.RSA小公钥指数攻击-Dangerous RSA</h2><p>首先，RSA的私钥指数指的是其中的参量<code>e</code>，当指数<code>e</code>和明文<code>m</code>足够小时，就能直接根据加密的<code>C = M ^ e % n</code>，得</p>
<script type="math/tex; mode=display">
M = \sqrt[e]{C}</script><p>这里因为</p>
<script type="math/tex; mode=display">
M ^ e < n</script><p>从而这个mod操作并没有起作用，然后直接使用gmpy2库求开三次方的C即可得明文。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io or http://a16ne.cn </span>
<span class="token comment"># @function: e = 3 It will be dangerous</span>
<span class="token comment"># -----------------------------------------------------</span>

<span class="token triple-quoted-string string">"""
原理:RSA
加密原理(算法): C = M ^ e % n
解密原理(算法): M = C ^ d % n
(其中C为密文，M为明文)
e很小时，经常为3，有时可能为2，M ^ e &lt; n ，此时M = \sqrt[e]&#123;C&#125;
"""</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum


e <span class="token operator">=</span> <span class="token number">0x3</span>
c <span class="token operator">=</span> <span class="token number">0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365</span>
n <span class="token operator">=</span> <span class="token number">0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793</span>


m <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
res <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
m <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>

<span class="token comment"># b'flag&#123;25df8caf006ee5db94d48144c33b2c3b&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>故flag为<code>flag&#123;25df8caf006ee5db94d48144c33b2c3b&#125;</code></p>
<h2 id="8-RSA一个明文多组n与c-RSA5"><a href="#8-RSA一个明文多组n与c-RSA5" class="headerlink" title="8.RSA一个明文多组n与c-RSA5"></a>8.RSA一个明文多组n与c-RSA5</h2><p>因为n的长度大于512了已经，所以大整数拆分应该很难，但是仍可以按下面思路进行解密。</p>
<p>这个题的思路也很好理解，不过首先要知道这里的公钥指数e、明文m是不变的。那有多组n、c的值，因为每组都有n = p * q，如果两组数据之间存在不为1的公约数的话，那么这个公约数就最有可能是组成n的p、q。由此可求出一组数据的p、q，有p、q能求出phi，进而求出d，进而实现对该组密文的解密。</p>
<p>这种攻击的偶然性很大，但是数据足够多的情况下可能性会大很多。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum


<span class="token keyword">def</span> <span class="token function">get_nscs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># ns列表中存的是n的值</span>
    ns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    cs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./1.txt'</span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> <span class="token builtin">file</span><span class="token punctuation">:</span>
        content <span class="token operator">=</span> <span class="token builtin">file</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            tempdata <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>content<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token builtin">len</span><span class="token punctuation">(</span>content<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">r'\n'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> tempdata <span class="token keyword">and</span> tempdata<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'n'</span><span class="token punctuation">:</span>
                ns<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tempdata<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> tempdata <span class="token keyword">and</span> tempdata<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'c'</span><span class="token punctuation">:</span>
                cs<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>tempdata<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> ns<span class="token punctuation">,</span> cs


<span class="token keyword">def</span> <span class="token function">get_np</span><span class="token punctuation">(</span>ns<span class="token punctuation">,</span> cs<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 传入ns数据数组</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> i <span class="token operator">==</span> j<span class="token punctuation">:</span>
                <span class="token keyword">continue</span>
            p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>ns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> ns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> p <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>ns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>ns<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 从上面的两组数据中选一组进行下面的计算</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>  <span class="token comment"># 可得公因数，从而拆分大整数。</span>
                <span class="token keyword">return</span> ns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> cs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> p


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    ns<span class="token punctuation">,</span> cs <span class="token operator">=</span> get_nscs<span class="token punctuation">(</span><span class="token punctuation">)</span>
    n<span class="token punctuation">,</span> c<span class="token punctuation">,</span> p <span class="token operator">=</span> get_np<span class="token punctuation">(</span>ns<span class="token punctuation">,</span> cs<span class="token punctuation">)</span>
    e <span class="token operator">=</span> <span class="token number">65537</span>
    q <span class="token operator">=</span> n <span class="token operator">//</span> p
    phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
    d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>


<span class="token triple-quoted-string string">"""
22822039733049388110936778173014765663663303811791283234361230649775805923902173438553927805407463106104699773994158375704033093471761387799852168337898526980521753614307899669015931387819927421875316304591521901592823814417756447695701045846773508629371397013053684553042185725059996791532391626429712416994990889693732805181947970071429309599614973772736556299404246424791660679253884940021728846906344198854779191951739719342908761330661910477119933428550774242910420952496929605686154799487839923424336353747442153571678064520763149793294360787821751703543288696726923909670396821551053048035619499706391118145067
19591441383958529435598729113936346657001352578357909347657257239777540424811749817783061233235817916560689138344041497732749011519736303038986277394036718790971374656832741054547056417771501234494768509780369075443550907847298246275717420562375114406055733620258777905222169702036494045086017381084272496162770259955811174440490126514747876661317750649488774992348005044389081101686016446219264069971370646319546429782904810063020324704138495608761532563310699753322444871060383693044481932265801505819646998535192083036872551683405766123968487907648980900712118052346174533513978009131757167547595857552370586353973
132585806383798600305426957307612567604223562626764190211333136246643723811046149337852966828729052476725552361132437370521548707664977123165279305052971868012755509160408641100548744046621516877981864180076497524093201404558036301820216274968638825245150755772559259575544101918590311068466601618472464832499
b'flag&#123;abdcbe5fd94e23b3de429223ab9c2fdf&#125;'
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>flag&#123;abdcbe5fd94e23b3de429223ab9c2fdf&#125;</code></p>
<h2 id="9-特殊模数-p、q求法已知-NCTF2019-childRSA"><a href="#9-特殊模数-p、q求法已知-NCTF2019-childRSA" class="headerlink" title="9.特殊模数(p、q求法已知)-[NCTF2019]childRSA"></a>9.特殊模数(p、q求法已知)-[NCTF2019]childRSA</h2><p>首先是他的算法，跟下面的差不多，我没有改关键的部分代码。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> choice
<span class="token keyword">from</span> Cryptodome<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> isPrime<span class="token punctuation">,</span> sieve_base <span class="token keyword">as</span> primes


flag <span class="token operator">=</span> <span class="token string">'123456'</span>
<span class="token keyword">def</span> <span class="token function">getPrime</span><span class="token punctuation">(</span>bits<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token number">2</span>
        <span class="token keyword">while</span> n<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> bits<span class="token punctuation">:</span>
            n <span class="token operator">*=</span> choice<span class="token punctuation">(</span>primes<span class="token punctuation">)</span>
        <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> n <span class="token operator">+</span> <span class="token number">1</span>


<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>primes<span class="token punctuation">)</span><span class="token punctuation">)</span>
e <span class="token operator">=</span> <span class="token number">0x10001</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>
p<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token punctuation">[</span>getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>
n <span class="token operator">=</span> p <span class="token operator">*</span> q
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token comment"># n = 32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span>
<span class="token comment"># c = 26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><code>from Cryptodome.Util.number import isPrime, sieve_base as primes</code>，这里的primes是前10000个素数，可以看到p和q是基于这前10000个素数的随机取出的乘积最后加一生成。</p>
<p>费马小定理可以扩展为</p>
<script type="math/tex; mode=display">
a^{t \times (p-1)} – 1 = k\times p</script><p>其中，a不是p的倍数，t、k是正整数。</p>
<p>又由上可知：</p>
<script type="math/tex; mode=display">
若L=t\times (p-1)\\\\
则a^L – 1 = k\times p</script><p>所以</p>
<script type="math/tex; mode=display">
a^L-1是p的倍数</script><p>而又因为</p>
<script type="math/tex; mode=display">
n=p\times q</script><p>故n也是p的倍数，所以p是n与a^L-1的最小公约数，所以求p只需</p>
<script type="math/tex; mode=display">
gcd(a^L-1,n)</script><p>手里有n，a可以从2开始，那L怎么来呢？</p>
<p>由<code>Pollard&#39; p-1 method</code></p>
<p>如果<code>p-1</code>正好是一些很小的质数的乘积，那么<code>p-1</code>就能整除n!，其中n是一个不太大的数。</p>
<p>那么</p>
<script type="math/tex; mode=display">
L=n!\\\\
只要求p = gcd(a^{n!}-1,n)\\\\
如果满足1<p<n\\\\
应该就能说p是n的因数</script><p>生成算法如下，其中令a为从2开始的数。</p>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210504002752365.png" alt="image-20210504002752365"></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> choice
<span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Cryptodome<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> isPrime<span class="token punctuation">,</span> sieve_base <span class="token keyword">as</span> primes


N <span class="token operator">=</span> <span class="token number">32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span>


<span class="token keyword">def</span> <span class="token function">Pollard_p_1</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> <span class="token number">5</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        f <span class="token operator">=</span> a
        <span class="token comment"># precompute</span>
        <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">80000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            f <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> n<span class="token punctuation">,</span> N<span class="token punctuation">)</span>
        <span class="token keyword">for</span> n <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">80000</span><span class="token punctuation">,</span> <span class="token number">104729</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            f <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> n<span class="token punctuation">,</span> N<span class="token punctuation">)</span>
            <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token number">15</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>f<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token number">1</span> <span class="token operator">&lt;</span> d <span class="token operator">&lt;</span> N<span class="token punctuation">:</span>
                    <span class="token keyword">return</span> d

        <span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
        a <span class="token operator">+=</span> <span class="token number">1</span>


p <span class="token operator">=</span> Pollard_p_1<span class="token punctuation">(</span>N<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>上面是优化过后的官方代码，虽然我看不太懂，但是下次出了类似的factordb接不出来的话，也可以用上面的脚本爆破。</p>
<p>解出的p</p>
<pre class="line-numbers language-none"><code class="language-none">p&#x3D;178449493212694205742332078583256205058672290603652616240227340638730811945224947826121772642204629335108873832781921390308501763661154638696935732709724016546955977529088135995838497476350749621442719690722226913635772410880516639651363626821442456779009699333452616953193799328647446968707045304702547915799734431818800374360377292309248361548868909066895474518333089446581763425755389837072166970684877011663234978631869703859541876049132713490090720408351108387971577438951727337962368478059295446047962510687695047494480605473377173021467764495541590394732685140829152761532035790187269724703444386838656193674253139<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>最后解一下m即可</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum


n <span class="token operator">=</span> <span class="token number">32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span>
p <span class="token operator">=</span> <span class="token number">178449493212694205742332078583256205058672290603652616240227340638730811945224947826121772642204629335108873832781921390308501763661154638696935732709724016546955977529088135995838497476350749621442719690722226913635772410880516639651363626821442456779009699333452616953193799328647446968707045304702547915799734431818800374360377292309248361548868909066895474518333089446581763425755389837072166970684877011663234978631869703859541876049132713490090720408351108387971577438951727337962368478059295446047962510687695047494480605473377173021467764495541590394732685140829152761532035790187269724703444386838656193674253139</span>
c <span class="token operator">=</span> <span class="token number">26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span>
e <span class="token operator">=</span> <span class="token number">0x10001</span>


q <span class="token operator">=</span> n <span class="token operator">//</span> p
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># n = 32849718197337581823002243717057659218502519004386996660885100592872201948834155543125924395614928962750579667346279456710633774501407292473006312537723894221717638059058796679686953564471994009285384798450493756900459225040360430847240975678450171551048783818642467506711424027848778367427338647282428667393241157151675410661015044633282064056800913282016363415202171926089293431012379261585078566301060173689328363696699811123592090204578098276704877408688525618732848817623879899628629300385790344366046641825507767709276622692835393219811283244303899850483748651722336996164724553364097066493953127153066970594638491950199605713033004684970381605908909693802373826516622872100822213645899846325022476318425889580091613323747640467299866189070780620292627043349618839126919699862580579994887507733838561768581933029077488033326056066378869170169389819542928899483936705521710423905128732013121538495096959944889076705471928490092476616709838980562233255542325528398956185421193665359897664110835645928646616337700617883946369110702443135980068553511927115723157704586595844927607636003501038871748639417378062348085980873502535098755568810971926925447913858894180171498580131088992227637341857123607600275137768132347158657063692388249513</span>
<span class="token comment"># c = 26308018356739853895382240109968894175166731283702927002165268998773708335216338997058314157717147131083296551313334042509806229853341488461087009955203854253313827608275460592785607739091992591431080342664081962030557042784864074533380701014585315663218783130162376176094773010478159362434331787279303302718098735574605469803801873109982473258207444342330633191849040553550708886593340770753064322410889048135425025715982196600650740987076486540674090923181664281515197679745907830107684777248532278645343716263686014941081417914622724906314960249945105011301731247324601620886782967217339340393853616450077105125391982689986178342417223392217085276465471102737594719932347242482670320801063191869471318313514407997326350065187904154229557706351355052446027159972546737213451422978211055778164578782156428466626894026103053360431281644645515155471301826844754338802352846095293421718249819728205538534652212984831283642472071669494851823123552827380737798609829706225744376667082534026874483482483127491533474306552210039386256062116345785870668331513725792053302188276682550672663353937781055621860101624242216671635824311412793495965628876036344731733142759495348248970313655381407241457118743532311394697763283681852908564387282605279108</span>

<span class="token comment"># b'NCTF&#123;Th3r3_ar3_1ns3cure_RSA_m0duli_7hat_at_f1rst_gl4nce_appe4r_t0_be_s3cur3&#125;'</span>
<span class="token comment"># flag&#123;Th3r3_ar3_1ns3cure_RSA_m0duli_7hat_at_f1rst_gl4nce_appe4r_t0_be_s3cur3&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="10-RSA给出e范围，爆破e-HDCTF2019-bbbbbbrsa"><a href="#10-RSA给出e范围，爆破e-HDCTF2019-bbbbbbrsa" class="headerlink" title="10.RSA给出e范围，爆破e-[HDCTF2019]bbbbbbrsa"></a>10.RSA给出e范围，爆破e-[HDCTF2019]bbbbbbrsa</h2><p>给出了e的范围为</p>
<script type="math/tex; mode=display">
50000<e<70000</script><p>对e爆破即可，下面是脚本，环境为<strong><code>python27</code></strong></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>
<span class="token keyword">import</span> sys
<span class="token keyword">if</span> sys<span class="token punctuation">.</span>version_info<span class="token punctuation">.</span>major <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> io
    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> io<span class="token punctuation">.</span>TextIOWrapper<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># 请不要删除上方代码，否则包含中文时无法运行</span>
<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64encode <span class="token keyword">as</span> b32encode
<span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64decode <span class="token keyword">as</span> b32decode
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token punctuation">,</span> gcd<span class="token punctuation">,</span> iroot
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> binascii <span class="token keyword">import</span> a2b_hex<span class="token punctuation">,</span> b2a_hex
<span class="token keyword">import</span> random
<span class="token keyword">import</span> libnum

p <span class="token operator">=</span> <span class="token number">177077389675257695042507998165006460849</span>
n <span class="token operator">=</span> <span class="token number">37421829509887796274897162249367329400988647145613325367337968063341372726061</span>
c <span class="token operator">=</span> <span class="token string">'==gMzYDNzIjMxUTNyIzNzIjMyYTM4MDM0gTMwEjNzgTM2UTN4cjNwIjN2QzM5ADMwIDNyMTO4UzM2cTM5kDN2MTOyUTO5YDM0czM3MjM'</span>
flag <span class="token operator">=</span> <span class="token string">"******************************"</span>
<span class="token triple-quoted-string string">"""
nbit = 128
p = getPrime(nbit)
q = getPrime(nbit)
n = p * q

print(p)
print(n)
"""</span>
q <span class="token operator">=</span> n <span class="token operator">//</span> p
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> b32decode<span class="token punctuation">(</span>c<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>


e <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">50000</span><span class="token punctuation">,</span> <span class="token number">70000</span><span class="token punctuation">)</span>


<span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            e <span class="token operator">-=</span> <span class="token number">1</span>
    d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token string">'flag'</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
        <span class="token keyword">print</span> flag
    <span class="token keyword">if</span> e <span class="token operator">&lt;</span> <span class="token number">50000</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
    e <span class="token operator">-=</span> <span class="token number">1</span>
<span class="token comment"># c = pow(int(b2a_hex(flag), 16), e, n)</span>

<span class="token comment"># print b32encode(str(c))[::-1]</span>

<span class="token comment"># c = 2373740699529364991763589324200093466206785561836101840381622237225512234632</span>
<span class="token comment"># flag&#123;rs4_1s_s1mpl3!#&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="11-RSA两次加密n有公因数、e不变且可求-BJDCTF2020-RSA"><a href="#11-RSA两次加密n有公因数、e不变且可求-BJDCTF2020-RSA" class="headerlink" title="11.RSA两次加密n有公因数、e不变且可求-[BJDCTF2020]RSA"></a>11.RSA两次加密n有公因数、e不变且可求-[BJDCTF2020]RSA</h2><p>分析代码，注意到针对相同的指数e进行了分开的两次加密，而这两次加密之中的q未变，这就很危险了，我们可以直接对两次的n求gcd，最大公约数一定就是q，由此又得两次的p，又因为e本身不变，第二次的明密文我们都知道，从而求得e，进而求得第一次加密的私钥d，进而求得明文m。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: UTF-8 -*-</span>
<span class="token keyword">import</span> sys
<span class="token keyword">if</span> sys<span class="token punctuation">.</span>version_info<span class="token punctuation">.</span>major <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>
    <span class="token keyword">import</span> io
    sys<span class="token punctuation">.</span>stdout <span class="token operator">=</span> io<span class="token punctuation">.</span>TextIOWrapper<span class="token punctuation">(</span>sys<span class="token punctuation">.</span>stdout<span class="token punctuation">.</span><span class="token builtin">buffer</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>

<span class="token comment"># 请不要删除上方代码，否则包含中文时无法运行</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum
<span class="token triple-quoted-string string">'''
# flag = open("flag", "rb").read()
flag = 'test'
e = 65537

p = getPrime(1024)
q = getPrime(1024)
assert (e &lt; 100000)

n = p * q

m = bytes_to_long(flag)
c = pow(m, e, n)
print c, n
print pow(294, e, n)

p = getPrime(1024)
n = p * q
m = bytes_to_long("BJD" * 32)
c = pow(m, e, n)
print c, n


output:
12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120  13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037
381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018
979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721  12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047
'''</span>
temp <span class="token operator">=</span> <span class="token number">381631268825806469518166370387352035475775677163615730759454343913563615970881967332407709901235637718936184198930226303761876517101208677107311006065728014220477966000620964056616058676999878976943319063836649085085377577273214792371548775204594097887078898598463892440141577974544939268247818937936607013100808169758675042264568547764031628431414727922168580998494695800403043312406643527637667466318473669542326169218665366423043579003388486634167642663495896607282155808331902351188500197960905672207046579647052764579411814305689137519860880916467272056778641442758940135016400808740387144508156358067955215018</span>
c1 <span class="token operator">=</span> <span class="token number">12641635617803746150332232646354596292707861480200207537199141183624438303757120570096741248020236666965755798009656547738616399025300123043766255518596149348930444599820675230046423373053051631932557230849083426859490183732303751744004874183062594856870318614289991675980063548316499486908923209627563871554875612702079100567018698992935818206109087568166097392314105717555482926141030505639571708876213167112187962584484065321545727594135175369233925922507794999607323536976824183162923385005669930403448853465141405846835919842908469787547341752365471892495204307644586161393228776042015534147913888338316244169120</span>
n1 <span class="token operator">=</span> <span class="token number">13508774104460209743306714034546704137247627344981133461801953479736017021401725818808462898375994767375627749494839671944543822403059978073813122441407612530658168942987820256786583006947001711749230193542370570950705530167921702835627122401475251039000775017381633900222474727396823708695063136246115652622259769634591309421761269548260984426148824641285010730983215377509255011298737827621611158032976420011662547854515610597955628898073569684158225678333474543920326532893446849808112837476684390030976472053905069855522297850688026960701186543428139843783907624317274796926248829543413464754127208843070331063037</span>
c2 <span class="token operator">=</span> <span class="token number">979153370552535153498477459720877329811204688208387543826122582132404214848454954722487086658061408795223805022202997613522014736983452121073860054851302343517756732701026667062765906277626879215457936330799698812755973057557620930172778859116538571207100424990838508255127616637334499680058645411786925302368790414768248611809358160197554369255458675450109457987698749584630551177577492043403656419968285163536823819817573531356497236154342689914525321673807925458651854768512396355389740863270148775362744448115581639629326362342160548500035000156097215446881251055505465713854173913142040976382500435185442521721</span>
n2 <span class="token operator">=</span> <span class="token number">12806210903061368369054309575159360374022344774547459345216907128193957592938071815865954073287532545947370671838372144806539753829484356064919357285623305209600680570975224639214396805124350862772159272362778768036844634760917612708721787320159318432456050806227784435091161119982613987303255995543165395426658059462110056431392517548717447898084915167661172362984251201688639469652283452307712821398857016487590794996544468826705600332208535201443322267298747117528882985955375246424812616478327182399461709978893464093245135530135430007842223389360212803439850867615121148050034887767584693608776323252233254261047</span>
q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>n1<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>
p1<span class="token punctuation">,</span> p2 <span class="token operator">=</span> n1 <span class="token operator">//</span> q<span class="token punctuation">,</span> n2 <span class="token operator">//</span> q
<span class="token comment"># 下面的这个爆破因为给了两组可爆破的对象，我选择了简单点的那一个</span>
<span class="token keyword">for</span> e <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> temp <span class="token operator">==</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">294</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">break</span>
<span class="token keyword">print</span> <span class="token string">'e='</span><span class="token punctuation">,</span> e
phi1 <span class="token operator">=</span> <span class="token punctuation">(</span>p1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi1<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n1<span class="token punctuation">)</span>
flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span> flag

<span class="token triple-quoted-string string">"""
e= 52361
BJD&#123;p_is_common_divisor&#125;
flag&#123;p_is_common_divisor&#125;
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="12-RSA共模攻击-BJDCTF2020-rsa-output"><a href="#12-RSA共模攻击-BJDCTF2020-rsa-output" class="headerlink" title="12.RSA共模攻击-[BJDCTF2020]rsa_output"></a>12.RSA共模攻击-[BJDCTF2020]rsa_output</h2><p>给出的output很明显就是上面的两条数据是公钥对，下面的两条是密文信息，很明显，两个公钥对的模数n是相同的。攻击原理基于<code>贝祖等式</code></p>
<p>这里就不在分析代码了，也不是特别难，知道贝祖等式的原理之后是很简单的<a target="_blank" rel="noopener" href="https://blog.csdn.net/Qi2456/article/details/79887411">贝祖等式原理</a></p>
<pre class="line-numbers language-py" data-language="py"><code class="language-py"><span class="token comment"># 输入a、b为互素的两个模指数，输出为s、t和q，q一般为1</span>
<span class="token keyword">def</span> <span class="token function">ext_euclid</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
     <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
         <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> a
     <span class="token keyword">else</span><span class="token punctuation">:</span>
         x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q <span class="token operator">=</span> ext_euclid<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span> <span class="token comment"># q = gcd(a, b) = gcd(b, a%b)</span>
         x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">)</span>
         <span class="token keyword">return</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>下面分析一下共模攻击的原理</p>
<script type="math/tex; mode=display">
\because s\times a+  t\times b=1\left ( 根据贝祖等式，gcd(a, b)=1 \right ) \\\\
得出的结果肯定是s、t为异号的两个数。\\\\
\therefore s \times e1+  t\times e2=1</script><p>下面分析为何没有私钥也能获得明文。</p>
<script type="math/tex; mode=display">
(c1^{s} \times  c2^{t}) \bmod n\\\\
=  (m^{e1} \bmod n)^{s} \times (m^{e2} \bmod n)^{t} \bmod n \\\\
=  m^{(e1 \times s + e2 \times t)} \bmod n \\\\
=  m \bmod n \\\\
=  m \\\\</script><p>c1、c2代换很显然，最后得出的m就是明文。</p>
<p>所以有下面<code>共模攻击的脚本</code></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum


n <span class="token operator">=</span> <span class="token number">21058339337354287847534107544613605305015441090508924094198816691219103399526800112802416383088995253908857460266726925615826895303377801614829364034624475195859997943146305588315939130777450485196290766249612340054354622516207681542973756257677388091926549655162490873849955783768663029138647079874278240867932127196686258800146911620730706734103611833179733264096475286491988063990431085380499075005629807702406676707841324660971173253100956362528346684752959937473852630145893796056675793646430793578265418255919376323796044588559726703858429311784705245069845938316802681575653653770883615525735690306674635167111</span>
e1 <span class="token operator">=</span> <span class="token number">2767</span>
e2 <span class="token operator">=</span> <span class="token number">3659</span>
c1 <span class="token operator">=</span> <span class="token number">20152490165522401747723193966902181151098731763998057421967155300933719378216342043730801302534978403741086887969040721959533190058342762057359432663717825826365444996915469039056428416166173920958243044831404924113442512617599426876141184212121677500371236937127571802891321706587610393639446868836987170301813018218408886968263882123084155607494076330256934285171370758586535415136162861138898728910585138378884530819857478609791126971308624318454905992919405355751492789110009313138417265126117273710813843923143381276204802515910527468883224274829962479636527422350190210717694762908096944600267033351813929448599</span>
c2 <span class="token operator">=</span> <span class="token number">11298697323140988812057735324285908480504721454145796535014418738959035245600679947297874517818928181509081545027056523790022598233918011261011973196386395689371526774785582326121959186195586069851592467637819366624044133661016373360885158956955263645614345881350494012328275215821306955212788282617812686548883151066866149060363482958708364726982908798340182288702101023393839781427386537230459436512613047311585875068008210818996941460156589314135010438362447522428206884944952639826677247819066812706835773107059567082822312300721049827013660418610265189288840247186598145741724084351633508492707755206886202876227</span>


<span class="token keyword">def</span> <span class="token function">ext_euclid</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> a
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q <span class="token operator">=</span> ext_euclid<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>  <span class="token comment"># q = gcd(a, b) = gcd(b, a%b)</span>
        x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q


s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> q <span class="token operator">=</span> ext_euclid<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> t<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n <span class="token comment"># powmod进行大数运算</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># b'BJD&#123;r3a_C0mmoN_moD@_4ttack&#125;'</span>
<span class="token comment"># flag&#123;r3a_C0mmoN_moD@_4ttack&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="13-RSA共模攻击-SameMod"><a href="#13-RSA共模攻击-SameMod" class="headerlink" title="13.RSA共模攻击-SameMod"></a>13.RSA共模攻击-SameMod</h2><p>一看名字就知道是共模攻击了，老脚本派上用场了，没啥分析的。</p>
<p>数据给出如下:</p>
<pre class="line-numbers language-data" data-language="data"><code class="language-data">&#123;6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249,773&#125;
&#123;6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249,839&#125;

message1&#x3D;3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349
message2&#x3D;5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>脚本如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum
n <span class="token operator">=</span> <span class="token number">6266565720726907265997241358331585417095726146341989755538017122981360742813498401533594757088796536341941659691259323065631249</span>
e1 <span class="token operator">=</span> <span class="token number">773</span>
e2 <span class="token operator">=</span> <span class="token number">839</span>
c1 <span class="token operator">=</span> <span class="token number">3453520592723443935451151545245025864232388871721682326408915024349804062041976702364728660682912396903968193981131553111537349</span>
c2 <span class="token operator">=</span> <span class="token number">5672818026816293344070119332536629619457163570036305296869053532293105379690793386019065754465292867769521736414170803238309535</span>

<span class="token keyword">def</span> <span class="token function">ext_euclid</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> a
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q <span class="token operator">=</span> ext_euclid<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span>  <span class="token comment"># q = gcd(a, b) = gcd(b, a%b)</span>
        x<span class="token punctuation">,</span> y <span class="token operator">=</span> y<span class="token punctuation">,</span> <span class="token punctuation">(</span>x <span class="token operator">-</span> <span class="token punctuation">(</span>a <span class="token operator">//</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> y<span class="token punctuation">)</span>
        <span class="token keyword">return</span> x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> q


s<span class="token punctuation">,</span> t<span class="token punctuation">,</span> q <span class="token operator">=</span> ext_euclid<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> gmpy2<span class="token punctuation">.</span>powmod<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> t<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n <span class="token comment"># powmod进行大数运算</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token comment"># 发现hex的结果并不对，原来加密的时候用的是ascii。。。手动分开</span>
<span class="token comment"># m = 102 108 97 103 123 119 104 101 110 119 101 116 104 105 110 107 105 116 105 115 112 111 115 115 105 98 108 101 125</span>
m <span class="token operator">=</span> <span class="token string">'102 108 97 103 123 119 104 101 110 119 101 116 104 105 110 107 105 116 105 115 112 111 115 115 105 98 108 101 125'</span>
<span class="token comment"># flag = libnum.n2s(int(m))</span>
flag <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># flag&#123;whenwethinkitispossible&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这题跟上面的不同的一点就是这个解出来的明文不是进行的hex的变换，而是ascii。</p>
<h2 id="14-RSA生成素数p、q相距很近；解方程组sympy库-GWCTF-2019-BabyRSA"><a href="#14-RSA生成素数p、q相距很近；解方程组sympy库-GWCTF-2019-BabyRSA" class="headerlink" title="14.RSA生成素数p、q相距很近；解方程组sympy库-[GWCTF 2019]BabyRSA"></a>14.RSA生成素数p、q相距很近；解方程组sympy库-[GWCTF 2019]BabyRSA</h2><p>这里给出的数据时N与加密后的数据，指数e也给出了，那就直接分解N得p、q。factordb.com就能出，直接在线解了。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python">p<span class="token operator">=</span><span class="token number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span>
q<span class="token operator">=</span><span class="token number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377748737</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>可以看到两个数只差了不到一千而已。</p>
<p>注意到后面有个解方程组的。。。因为flag被分成了两部分，分别做了两个运算，这时候python还有一个专门的库针对解方程组。。。果然python出了不能帮你生孩子，其他的都能帮你做。。。库名为sympy，tql。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""
import hashlib
# import sympy
from Cryptodome.Util.number import *

flag = 'GWHT&#123;******&#125;'
secret = '******'

assert(len(flag) == 38)

half = len(flag) / 2

flag1 = flag[:half]
flag2 = flag[half:]

secret_num = getPrime(1024) * bytes_to_long(secret)

p = sympy.nextprime(secret_num)
q = sympy.nextprime(p)

N = p * q

e = 0x10001

F1 = bytes_to_long(flag1)
F2 = bytes_to_long(flag2)

c1 = F1 + F2
c2 = pow(F1, 3) + pow(F2, 3)
assert(c2 &lt; N)

m1 = pow(c1, e, N)
m2 = pow(c2, e, N)

output = open('secret', 'w')
output.write('N=' + str(N) + '\n')
output.write('m1=' + str(m1) + '\n')
output.write('m2=' + str(m2) + '\n')
output.close()

"""</span>
<span class="token keyword">import</span> sympy
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum

e <span class="token operator">=</span> <span class="token number">0x10001</span>
N <span class="token operator">=</span> <span class="token number">636585149594574746909030160182690866222909256464847291783000651837227921337237899651287943597773270944384034858925295744880727101606841413640006527614873110651410155893776548737823152943797884729130149758279127430044739254000426610922834573094957082589539445610828279428814524313491262061930512829074466232633130599104490893572093943832740301809630847541592548921200288222432789208650949937638303429456468889100192613859073752923812454212239908948930178355331390933536771065791817643978763045030833712326162883810638120029378337092938662174119747687899484603628344079493556601422498405360731958162719296160584042671057160241284852522913676264596201906163</span>
c1 <span class="token operator">=</span> <span class="token number">90009974341452243216986938028371257528604943208941176518717463554774967878152694586469377765296113165659498726012712288670458884373971419842750929287658640266219686646956929872115782173093979742958745121671928568709468526098715927189829600497283118051641107305128852697032053368115181216069626606165503465125725204875578701237789292966211824002761481815276666236869005129138862782476859103086726091860497614883282949955023222414333243193268564781621699870412557822404381213804026685831221430728290755597819259339616650158674713248841654338515199405532003173732520457813901170264713085107077001478083341339002069870585378257051150217511755761491021553239</span>
c2 <span class="token operator">=</span> <span class="token number">487443985757405173426628188375657117604235507936967522993257972108872283698305238454465723214226871414276788912058186197039821242912736742824080627680971802511206914394672159240206910735850651999316100014691067295708138639363203596244693995562780286637116394738250774129759021080197323724805414668042318806010652814405078769738548913675466181551005527065309515364950610137206393257148357659666687091662749848560225453826362271704292692847596339533229088038820532086109421158575841077601268713175097874083536249006018948789413238783922845633494023608865256071962856581229890043896939025613600564283391329331452199062858930374565991634191495137939574539546</span>
p <span class="token operator">=</span> <span class="token number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377747699</span>
q <span class="token operator">=</span> <span class="token number">797862863902421984951231350430312260517773269684958456342860983236184129602390919026048496119757187702076499551310794177917920137646835888862706126924088411570997141257159563952725882214181185531209186972351469946269508511312863779123205322378452194261217016552527754513215520329499967108196968833163329724620251096080377748737</span>

phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>

m1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span>
m2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m2<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m2<span class="token punctuation">)</span><span class="token punctuation">)</span>

f1<span class="token punctuation">,</span> f2 <span class="token operator">=</span> sympy<span class="token punctuation">.</span>symbols<span class="token punctuation">(</span><span class="token string">'f1 f2'</span><span class="token punctuation">)</span>  <span class="token comment"># 引入符号</span>
flag <span class="token operator">=</span> sympy<span class="token punctuation">.</span>solve<span class="token punctuation">(</span><span class="token punctuation">[</span>f1 <span class="token operator">+</span> f2 <span class="token operator">-</span> m1<span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>f1<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>f2<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">-</span> m2<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>f1<span class="token punctuation">,</span> f2<span class="token punctuation">]</span><span class="token punctuation">)</span>   <span class="token comment"># 写入需要解的方程组，f1 + f2 = c1，pow(f1, 3) + pow(f2, 3) = c2</span>
f1<span class="token punctuation">,</span> f2 <span class="token operator">=</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> flag<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
F1<span class="token punctuation">,</span> F2 <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>f1<span class="token punctuation">,</span> f2<span class="token punctuation">]</span><span class="token punctuation">)</span>
flag <span class="token operator">=</span> F1 <span class="token operator">+</span> F2
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># b'GWHT&#123;f709e0e2cfe7e530ca8972959a1033b2&#125;'</span>
<span class="token comment"># flag&#123;f709e0e2cfe7e530ca8972959a1033b2&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSA有c、d、e，并且p、q相距很近，爆破e-d-1-k-p-1-q-1-中的k-NCTF2019-babyRSA"><a href="#RSA有c、d、e，并且p、q相距很近，爆破e-d-1-k-p-1-q-1-中的k-NCTF2019-babyRSA" class="headerlink" title="RSA有c、d、e，并且p、q相距很近，爆破e*d-1=k*(p-1)*(q-1)中的k-[NCTF2019]babyRSA"></a>RSA有c、d、e，并且p、q相距很近，爆破<code>e*d-1=k*(p-1)*(q-1)</code>中的k-[NCTF2019]babyRSA</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Cryptodome<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum
<span class="token keyword">import</span> sympy

<span class="token triple-quoted-string string">"""
def nextPrime(n):
    n += 2 if n &amp; 1 else 1  # 使n为奇数
    while not isPrime(n):
        n += 2
    return n


p = getPrime(1024)
q = nextPrime(p)
n = p * q
e = 0x10001
d = inverse(e, (p-1) * (q-1))
c = pow(bytes_to_long(flag.encode()), e, n)
"""</span>
e <span class="token operator">=</span> <span class="token number">0x10001</span>
d <span class="token operator">=</span> <span class="token number">19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span>
c <span class="token operator">=</span> <span class="token number">5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span>

<span class="token comment"># 有 c d e, 知道e*d = 1 % (p-1)*(q-1) 则e*d-1 = k * (p-1)*(q-1)</span>
<span class="token comment"># 可以爆破k要得到(p-1)*(q-1)</span>

<span class="token comment"># 取k的范围</span>
<span class="token comment"># e*d - 1是2063到2064位 、 (p-1)*(q-1)是1024+1024位</span>
<span class="token comment"># 则k取2^15~2^16</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token number">2</span> <span class="token operator">**</span> i <span class="token operator">&lt;</span> e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&lt;</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
        <span class="token comment"># 2063</span>

<span class="token comment"># (e*d-1)对k的模为0</span>
<span class="token comment"># 我们还知道q是p的下一个素数 俩者大小相差不大</span>
<span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">**</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        p <span class="token operator">=</span> sympy<span class="token punctuation">.</span>prevprime<span class="token punctuation">(</span>gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> k<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># 通过sympy.prevprime(n)得到小于n的最大素数</span>
        q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> k<span class="token punctuation">:</span>
            <span class="token comment"># 验证pq是否正确</span>
            <span class="token keyword">break</span>
n <span class="token operator">=</span> q <span class="token operator">*</span> p
<span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment"># b'NCTF&#123;70u2_nn47h_14_v3ry_gOO0000000d&#125;'</span>
<span class="token comment"># flag&#123;70u2_nn47h_14_v3ry_gOO0000000d&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSA存在阶乘一般可能是威尔逊定理-RoarCTF2019-babyRSA"><a href="#RSA存在阶乘一般可能是威尔逊定理-RoarCTF2019-babyRSA" class="headerlink" title="RSA存在阶乘一般可能是威尔逊定理-[RoarCTF2019]babyRSA"></a>RSA存在阶乘一般可能是威尔逊定理-[RoarCTF2019]babyRSA</h2><p>这题看到取素因数p、q的时候用到了阶乘，我所学过的数论知识里，用到哪个不会哪个(我太菜了)，联想到威尔逊定理</p>
<p><strong>威尔逊定理</strong>: </p>
<script type="math/tex; mode=display">
(p-1)! ☰ -1 \space (\bmod p)</script><p><strong>懒得写数学公式了，看看师傅写的</strong></p>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210505002337976.png" alt="公式分析"></p>
<p>代码如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sympy
<span class="token keyword">import</span> libnum
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> random

<span class="token triple-quoted-string string">"""
def myGetPrime():
    A = getPrime(513)
    print(A)
    B = A - random.randint(1e3, 1e5)
    print(B)
    return sympy.nextPrime(B! % A)


p = myGetPrime()
# A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407
# B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596

q = myGetPrime()
# A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927
# B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026

r = myGetPrime()

n = p * q * r
# n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733
c = pow(flag, e, n)
# e=0x1001
# c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428
# so,what is the flag?
"""</span>


<span class="token keyword">def</span> <span class="token function">myCrackPrime</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span> B<span class="token punctuation">)</span><span class="token punctuation">:</span>
    temp <span class="token operator">=</span> <span class="token number">1</span>  <span class="token comment"># temp代表的就是前面的那一堆模A</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>B<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> A<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># B+1到A-2相乘并对A取模运算</span>
        temp <span class="token operator">*=</span> i
        temp <span class="token operator">%=</span> A
    p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>temp<span class="token punctuation">,</span> A<span class="token punctuation">)</span>
    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>p<span class="token punctuation">)</span>


c <span class="token operator">=</span> <span class="token number">75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span>
e <span class="token operator">=</span> <span class="token number">0x1001</span>
A1 <span class="token operator">=</span> <span class="token number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span>
B1 <span class="token operator">=</span> <span class="token number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span>
A2 <span class="token operator">=</span> <span class="token number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span>
B2 <span class="token operator">=</span> <span class="token number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span>

p <span class="token operator">=</span> myCrackPrime<span class="token punctuation">(</span>A1<span class="token punctuation">,</span> B1<span class="token punctuation">)</span>
q <span class="token operator">=</span> myCrackPrime<span class="token punctuation">(</span>A2<span class="token punctuation">,</span> B2<span class="token punctuation">)</span>
n <span class="token operator">=</span> p<span class="token operator">*</span>q
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># b'RoarCTF&#123;wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A&#125;'</span>
<span class="token comment"># flag&#123;wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSA基础-BJDCTF-2nd-rsa0"><a href="#RSA基础-BJDCTF-2nd-rsa0" class="headerlink" title="RSA基础-[BJDCTF 2nd]rsa0"></a>RSA基础-[BJDCTF 2nd]rsa0</h2><p>下面是给出的数据</p>
<pre class="line-numbers language-data" data-language="data"><code class="language-data">┌──(m4xlmum㉿kali)-[~]
└─$ nc node3.buuoj.cn 25542                                                                               
e&#x3D;9261487

p+q&#x3D;20595382049497133602969407920821468563134851716758639240341261319944154912707581616052449604524075346372380963546505863644441704744659753451822126457089790

p-q&#x3D;4245973275379937339800254871751794029621135583348704973009466583288068856613096499337640761469161236555087061518110144521735865913438069893475880154489552

c&#x3D;35203479693629584261060479309205133578584402518738719887772606759170491533838367761859632450395468036351668015403145831512053843021243437105985391616736993290885277829036524368069739060914022302728552684082257558900451341072367705779206632503639191730121057845474173642138365331273678118513379679105423351519

flag&#x3D;??????<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>直接写个python脚本有手就行。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> libnum

e <span class="token operator">=</span> <span class="token number">9261487</span>
paddq <span class="token operator">=</span> <span class="token number">20595382049497133602969407920821468563134851716758639240341261319944154912707581616052449604524075346372380963546505863644441704744659753451822126457089790</span>

psubq <span class="token operator">=</span> <span class="token number">4245973275379937339800254871751794029621135583348704973009466583288068856613096499337640761469161236555087061518110144521735865913438069893475880154489552</span>

c <span class="token operator">=</span> <span class="token number">35203479693629584261060479309205133578584402518738719887772606759170491533838367761859632450395468036351668015403145831512053843021243437105985391616736993290885277829036524368069739060914022302728552684082257558900451341072367705779206632503639191730121057845474173642138365331273678118513379679105423351519</span>

p <span class="token operator">=</span> <span class="token punctuation">(</span>paddq <span class="token operator">+</span> psubq<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>
q <span class="token operator">=</span> paddq <span class="token operator">-</span> p
n <span class="token operator">=</span> p <span class="token operator">*</span> q
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>

<span class="token comment"># b'flag&#123;28a64bf0-5990-4f4e-be28-3c69ad6a76b8&#125;\n'</span>
<span class="token comment"># flag&#123;28a64bf0-5990-4f4e-be28-3c69ad6a76b8&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSA各种脚本计算方程组-BJDCTF-2nd-rsa1"><a href="#RSA各种脚本计算方程组-BJDCTF-2nd-rsa1" class="headerlink" title="RSA各种脚本计算方程组-[BJDCTF 2nd]rsa1"></a>RSA各种脚本计算方程组-[BJDCTF 2nd]rsa1</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">e<span class="token operator">=</span><span class="token number">10285259</span>

p<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span>q<span class="token operator">^</span><span class="token number">2</span><span class="token operator">=</span><span class="token number">148193034686093875606936772901796192571303001115029291517405331993393203269281099081710974212574713219081347567428971014001283118773089717464796658514005538220560363869356411053339131801477137920584165364824035655608984148638721704961444994765607118407752424527350332483861193466582296836758326629420997138530</span>

p<span class="token operator">-</span>q<span class="token operator">=</span><span class="token number">3402414624993633952217953385870975916545481408651416647913976811822639004934920485060318354591101655404901664274031766949876928066547558116562382034794768</span>

c<span class="token operator">=</span><span class="token number">6108352927563244872746082764308283395262145280733588398003302384682546586297303948508036522388063991258529485895131083518717700697235961114589046843808427758029471152474445214855919689222452290920139403258212312495541027718270900389472818404179516997158391906474152124429458221729453255084862167956482137326</span>

flag<span class="token operator">=</span>??????<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>数据如上所示，直接解吧，下面用了sympy和z3-solver两种解决了方程组，感觉自己应该也可以算的，但是总是错，（我数学本来就不好，还是直接添加到脚本里让它做吧）</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> gmpy2<span class="token punctuation">,</span> sympy<span class="token punctuation">,</span> libnum<span class="token punctuation">,</span> factordb<span class="token punctuation">.</span>factordb<span class="token punctuation">,</span> z3

e <span class="token operator">=</span> <span class="token number">10285259</span>
c <span class="token operator">=</span> <span class="token number">6108352927563244872746082764308283395262145280733588398003302384682546586297303948508036522388063991258529485895131083518717700697235961114589046843808427758029471152474445214855919689222452290920139403258212312495541027718270900389472818404179516997158391906474152124429458221729453255084862167956482137326</span>

p2q2 <span class="token operator">=</span> <span class="token number">148193034686093875606936772901796192571303001115029291517405331993393203269281099081710974212574713219081347567428971014001283118773089717464796658514005538220560363869356411053339131801477137920584165364824035655608984148638721704961444994765607118407752424527350332483861193466582296836758326629420997138530</span>
pq <span class="token operator">=</span> <span class="token number">3402414624993633952217953385870975916545481408651416647913976811822639004934920485060318354591101655404901664274031766949876928066547558116562382034794768</span>

<span class="token triple-quoted-string string">"""下面用sympy算
p, q = sympy.symbols('p q')
flag = sympy.solve([p*p + q*q - p2q2, p - q - pq], [p, q])
print(flag)
"""</span>
<span class="token triple-quoted-string string">"""下面的不行
# 那就直接干了，先求n=p*q再在线分解大整数n。
n = (p2q2 - pow(pq, 2)) // 2
print(n)
p = factordb.factordb.FactorDB(n).connect().json()['factors']
print(p)
"""</span>
<span class="token triple-quoted-string string">"""
# 脚本好是好，就是没有人思维活跃
n = (p2q2 - pow(pq, 2)) // 2
paddq = gmpy2.iroot(p2q2 + 2*n, 2)
paddq = int(paddq[1])
p = (paddq + pq) // 2
print(p)
q = paddq - p
"""</span>
<span class="token triple-quoted-string string">"""
# z3脚本做
s = z3.Solver()
p, q = z3.Ints('p q')
s.add(p * p + q * q == p2q2)
s.add(p - q == pq)
s.add(p > 0)
s.add(q > 0)
arr = []
if s.check() == z3.sat:
    arr = s.model()
print(arr)
"""</span>

q <span class="token operator">=</span> <span class="token number">6736944796996960993603438083709293466421599211209692971073886968784871077399620232086062402949866000920159626464399272591808807316300065266948174349941919</span>
p <span class="token operator">=</span> <span class="token number">10139359421990594945821391469580269382967080619861109618987863780607510082334540717146380757540967656325061290738431039541685735382847623383510556384736687</span>
n <span class="token operator">=</span> <span class="token punctuation">(</span>p2q2 <span class="token operator">-</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>pq<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span>

phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>


<span class="token triple-quoted-string string">"""
14337636555117934521601169772852941750969644747881248278436389781692555060089291958279532414690214903050
b'flag&#123;e74940d4-efb7-4015-901a-69fc671ce971&#125;\n'
flag&#123;e74940d4-efb7-4015-901a-69fc671ce971&#125;
"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="C语言写的密码-分析"><a href="#C语言写的密码-分析" class="headerlink" title="C语言写的密码-分析"></a>C语言写的密码-分析</h1><h2 id="单表替换密码-AFCTF2018-Single"><a href="#单表替换密码-AFCTF2018-Single" class="headerlink" title="单表替换密码-[AFCTF2018]Single"></a>单表替换密码-[AFCTF2018]Single</h2><p>简单分析一下文件，很简单，简单地测试一下给的cpp文件，判断应该是个简单的单表替换密码，下面是c文件的分析</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;bits/stdc++.h></span></span>
<span class="token keyword">using</span> <span class="token keyword">namespace</span> std<span class="token punctuation">;</span>

<span class="token comment">/*
int main()
&#123;
	freopen("Plain.txt","r",stdin);
	freopen("Cipher.txt","w",stdout);
	map&lt;char, char> f;
	int arr[26];
	for(int i=0;i&lt;26;++i)&#123;
		arr[i]=i;
	&#125;
	random_shuffle(arr,arr+26);
	for(int i=0;i&lt;26;++i)&#123;
		f['a'+i]='a'+arr[i];
		f['A'+i]='A'+arr[i];
	&#125;
	char ch;
	while((ch=getchar())!=EOF)&#123;
		if(f.count(ch))&#123;
			putchar(f[ch]);
		&#125;else&#123;
			putchar(ch);
		&#125;
	&#125;
	return 0;
&#125;
*/</span>


<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    map<span class="token operator">&lt;</span><span class="token keyword">char</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token operator">></span> f<span class="token punctuation">;</span>
	<span class="token keyword">int</span> arr<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i<span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token function">random_shuffle</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> arr<span class="token operator">+</span><span class="token number">26</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">//输出一下证明是伪随机：12 1 9 24 0 11 25 21 4 15 18 5 14 13 23 16 6 3 20 17 8 19 22 10 2 7</span>
	<span class="token comment">/*
	for(int i=0;i&lt;26;++i)&#123;
		cout &lt;&lt; 'a' + arr[i] &lt;&lt; " ";
	&#125;
	*/</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		f<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token operator">+</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'a'</span><span class="token operator">+</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
		f<span class="token punctuation">[</span><span class="token string">'A'</span><span class="token operator">+</span>i<span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'A'</span><span class="token operator">+</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		cout <span class="token operator">&lt;&lt;</span> f<span class="token punctuation">[</span><span class="token string">'a'</span> <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">26</span><span class="token punctuation">;</span><span class="token operator">++</span>i<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		cout <span class="token operator">&lt;&lt;</span> f<span class="token punctuation">[</span><span class="token string">'A'</span> <span class="token operator">+</span> i<span class="token punctuation">]</span> <span class="token operator">&lt;&lt;</span> <span class="token string">" "</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>

	<span class="token keyword">char</span> ch<span class="token punctuation">;</span>
	<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ch<span class="token operator">=</span><span class="token function">getchar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">!=</span><span class="token constant">EOF</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>f<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
			<span class="token function">putchar</span><span class="token punctuation">(</span>f<span class="token punctuation">[</span>ch<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
			<span class="token function">putchar</span><span class="token punctuation">(</span>ch<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">&#125;</span>
	<span class="token punctuation">&#125;</span>
	<span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210507010035419.png" alt="image-20210507010035419"></p>
<p>猜测应该是a-z替换为上表。写python脚本</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> string


ciphertext <span class="token operator">=</span> <span class="token string">'m b j y a l z v e p s f o n x q g d u r i t w k c h'</span>
flag <span class="token operator">=</span> <span class="token string">'mljrl&#123;Xv_I_lxiny_er_neja_rDc&#125;'</span>

cipher <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
tempkey <span class="token operator">=</span> ciphertext<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>
tempval <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>tempkey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher<span class="token punctuation">[</span>tempkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> tempval<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
    cipher<span class="token punctuation">[</span>tempkey<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> tempval<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>upper<span class="token punctuation">(</span><span class="token punctuation">)</span>


res <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        res <span class="token operator">+=</span> cipher<span class="token punctuation">[</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        res <span class="token operator">+=</span> flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span>


<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>


<span class="token comment"># afctf&#123;Oh_U_found_it_nice_tRy&#125;</span>
<span class="token comment"># flag&#123;Oh_U_found_it_nice_tRy&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="真正的其他-奇奇怪怪的"><a href="#真正的其他-奇奇怪怪的" class="headerlink" title="真正的其他-奇奇怪怪的"></a>真正的其他-奇奇怪怪的</h1><h2 id="1-sage求方程组、matlab求方程-网鼎杯-2020-青龙组-boom"><a href="#1-sage求方程组、matlab求方程-网鼎杯-2020-青龙组-boom" class="headerlink" title="1.sage求方程组、matlab求方程[网鼎杯 2020 青龙组]boom"></a>1.sage求方程组、matlab求方程[网鼎杯 2020 青龙组]boom</h2><p>level1的md5直接在线就有<code>en5oy</code></p>
<p>level2正好练习一下sage使用，给的方程式组如下：</p>
<pre class="line-numbers language-mathematica" data-language="mathematica"><code class="language-mathematica">This time:Here are have some formulas
3x-y+z&#x3D;185
2x+3y-z&#x3D;321
x+y+z&#x3D;173
input: x &#x3D;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>写的sage脚本如下：</p>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210507013443600.png" alt="image-20210507013443600"></p>
<p><img src="/2020/11/25/BUUOJ-crypto/image-20210507013550186.png" alt="image-20210507013550186"></p>
<p>解出来没用，屏幕一闪而过，拿出了我的ida开始逆向分析。。。主要代码如下</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token keyword">int</span> __cdecl <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">,</span> <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>envp<span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">int</span> v3<span class="token punctuation">;</span> <span class="token comment">// eax</span>
  <span class="token keyword">char</span> Str<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+24h] [ebp-128h] BYREF</span>
  <span class="token keyword">unsigned</span> __int8 v6<span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+56h] [ebp-F6h] BYREF</span>
  _DWORD v7<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+88h] [ebp-C4h]</span>
  <span class="token keyword">unsigned</span> <span class="token keyword">int</span> v8<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// [esp+C8h] [ebp-84h] BYREF</span>
  __int64 v9<span class="token punctuation">;</span> <span class="token comment">// [esp+120h] [ebp-2Ch] BYREF</span>
  <span class="token keyword">int</span> v10<span class="token punctuation">;</span> <span class="token comment">// [esp+12Ch] [ebp-20h] BYREF</span>
  <span class="token keyword">int</span> v11<span class="token punctuation">;</span> <span class="token comment">// [esp+130h] [ebp-1Ch] BYREF</span>
  <span class="token keyword">int</span> v12<span class="token punctuation">;</span> <span class="token comment">// [esp+134h] [ebp-18h] BYREF</span>
  <span class="token keyword">int</span> v13<span class="token punctuation">;</span> <span class="token comment">// [esp+138h] [ebp-14h]</span>
  <span class="token keyword">int</span> i<span class="token punctuation">;</span> <span class="token comment">// [esp+13Ch] [ebp-10h]</span>

  <span class="token function">__main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">menu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">70</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">229</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">239</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">230</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">22</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">90</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">251</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">54</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">18</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">23</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">68</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">106</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">45</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">189</span><span class="token punctuation">;</span>
  v7<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"first:this string md5:46e5efe6165a5afb361217446a2dbd01"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%s"</span><span class="token punctuation">,</span> Str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">MD5Init</span><span class="token punctuation">(</span>v8<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v3 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>Str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">MD5Update</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>v8<span class="token punctuation">,</span> Str<span class="token punctuation">,</span> v3<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">MD5Final</span><span class="token punctuation">(</span>v8<span class="token punctuation">,</span> v6<span class="token punctuation">)</span><span class="token punctuation">;</span>
  v13 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> <span class="token number">15</span><span class="token punctuation">;</span> <span class="token operator">++</span>i <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span> v6<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> v7<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
      v13 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v13 <span class="token operator">!=</span> <span class="token number">1</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Game over"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Great next level"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"This time:Here are have some formulas"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"3x-y+z=185"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"2x+3y-z=321"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"x+y+z=173"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"input: x = "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"input: y = "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v11<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"input : z = "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v10<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token number">3</span> <span class="token operator">*</span> v12 <span class="token operator">-</span> v11 <span class="token operator">+</span> v10 <span class="token operator">!=</span> <span class="token number">185</span> <span class="token operator">||</span> <span class="token number">2</span> <span class="token operator">*</span> v12 <span class="token operator">+</span> <span class="token number">3</span> <span class="token operator">*</span> v11 <span class="token operator">-</span> v10 <span class="token operator">!=</span> <span class="token number">321</span> <span class="token operator">||</span> v11 <span class="token operator">+</span> v12 <span class="token operator">+</span> v10 <span class="token operator">!=</span> <span class="token number">173</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Game over"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Great last level coming..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"pause"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">system</span><span class="token punctuation">(</span><span class="token string">"cls"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Last time: Kill it"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"x*x+x-7943722218936282=0"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"input x: "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">scanf</span><span class="token punctuation">(</span><span class="token string">"%lld"</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>v9<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span> v9 <span class="token operator">*</span> <span class="token punctuation">(</span>v9 <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0x1C38C5F50DD7DALL</span> <span class="token punctuation">)</span>
  <span class="token punctuation">&#123;</span>
    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Game over"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token function">puts</span><span class="token punctuation">(</span><span class="token string">"Great This is your FLAG"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"flag&#123;%s_%d%d%d_%lld&#125;"</span><span class="token punctuation">,</span> Str<span class="token punctuation">,</span> v12<span class="token punctuation">,</span> v11<span class="token punctuation">,</span> v10<span class="token punctuation">,</span> v9<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-flag" data-language="flag"><code class="language-flag">flag&#123;en5oy_746831_89127561&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>emmm，matlab跟sage都挺好用的，很难抉择啊，再等等吧那，到时候遇见好玩的看看那个用着更爽。</p>
<h2 id="2-base表爆破-python-，-WUSTCTF2020-B-se"><a href="#2-base表爆破-python-，-WUSTCTF2020-B-se" class="headerlink" title="2.base表爆破(python)，[WUSTCTF2020]B@se"></a>2.base表爆破(python)，[WUSTCTF2020]B@se</h2><pre class="line-numbers language-none"><code class="language-none">密文：MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD&#x3D;&#x3D;
JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs****kxyz012789+&#x2F;

oh holy shit, something is missing...<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>一看就是特殊的base64，看见几个*，应该就是base64替换表缺失了4位，emmm，明天再写脚本，眼睁不开了。。。</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding: utf-8 -*-</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token comment"># @Author  : M4XLMUM                                  </span>
<span class="token comment"># @website : http://a16n.github.io</span>
<span class="token comment"># -----------------------------------------------------</span>
<span class="token keyword">import</span> base64
<span class="token keyword">import</span> string



cipher <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
m <span class="token operator">=</span> <span class="token string">'MyLkTaP3FaA7KOWjTmKkVjWjVzKjdeNvTnAjoH9iZOIvTeHbvD=='</span>
data1 <span class="token operator">=</span> <span class="token string">'JASGBWcQPRXEFLbCDIlmnHUVKTYZdMovwipatNOefghq56rs&#123;0&#125;&#123;1&#125;&#123;2&#125;&#123;3&#125;kxyz012789+/'</span>   <span class="token comment"># 缺 j u 3 4</span>
s <span class="token operator">=</span> <span class="token string">'ju34'</span>
data2 <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_uppercase <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits <span class="token operator">+</span> <span class="token string">'+/'</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> s<span class="token punctuation">:</span>
        <span class="token keyword">for</span> a <span class="token keyword">in</span> s<span class="token punctuation">:</span>
            <span class="token keyword">for</span> b <span class="token keyword">in</span> s<span class="token punctuation">:</span>
                <span class="token keyword">if</span> i <span class="token operator">!=</span> j <span class="token keyword">and</span> i <span class="token operator">!=</span> a <span class="token keyword">and</span> i <span class="token operator">!=</span> b <span class="token keyword">and</span> j <span class="token operator">!=</span> a <span class="token keyword">and</span> j <span class="token operator">!=</span> b <span class="token keyword">and</span> a <span class="token operator">!=</span> b<span class="token punctuation">:</span>
                    flag <span class="token operator">=</span> <span class="token string">""</span>
                    cipherkey <span class="token operator">=</span> data1<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> j<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
                    <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cipherkey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        cipher<span class="token punctuation">[</span>cipherkey<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> data2<span class="token punctuation">[</span>t<span class="token punctuation">]</span>
                    <span class="token comment"># print(cipher)</span>
                    <span class="token keyword">for</span> t <span class="token keyword">in</span> m<span class="token punctuation">:</span>
                        <span class="token keyword">try</span><span class="token punctuation">:</span>
                            flag <span class="token operator">+=</span> cipher<span class="token punctuation">[</span>t<span class="token punctuation">]</span>
                        <span class="token keyword">except</span><span class="token punctuation">:</span>
                            flag <span class="token operator">+=</span> t
                    flag <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>


<span class="token comment"># b'wctf2020&#123;base64_1s_v3ry_e@sy_and_fuN&#125;'</span>
<span class="token comment"># flag&#123;base64_1s_v3ry_e@sy_and_fuN&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="RSA之p-1可整除e、开大次方根-NCTF2019-easyRSA"><a href="#RSA之p-1可整除e、开大次方根-NCTF2019-easyRSA" class="headerlink" title="RSA之p-1可整除e、开大次方根-[NCTF2019]easyRSA"></a>RSA之p-1可整除e、开大次方根-[NCTF2019]easyRSA</h2><p><strong>稍微有点难，下面是官方的wp</strong></p>
<p>题面十分简洁，甚至都给出了<code>p, q</code>。乍一看，肯定觉得这是一道<strong>送分题</strong>，然而事实远非如此。</p>
<hr>
<p>正常情况下的RSA都要求<code>e</code>和<code>phi(n)</code>要互素，不过也有一些<code>e</code>和<code>phi(n)</code>有很小的公约数的题目，这些题目基本都能通过计算<code>e</code>对<code>phi(n)</code>的逆元<code>d</code>来求解。</p>
<p>然而本题则为<code>e</code>和<code>p-1</code>(或<code>q-1</code>)的最大公约数就是<code>e</code>本身，也就是说<code>e | p-1</code>，只有对<code>c</code>开<code>e</code>次方根才行。<br>可以将同余方程</p>
<script type="math/tex; mode=display">
m^e \equiv c \quad (\text{mod}\ n)</script><p>化成</p>
<script type="math/tex; mode=display">
\begin{aligned}
m^e &\equiv c \quad (\text{mod}\ p)\newline
m^e &\equiv c \quad (\text{mod}\ q)
\end{aligned}</script><p>然后分别在<code>GF(p)</code>和<code>GF(q)</code>上对<code>c</code>开<code>e=0x1337</code>次方根，再用<code>CRT</code>组合一下即可得到在<code>mod n</code>下的解。</p>
<hr>
<p>问题是，<strong>如何在有限域内开根</strong>？</p>
<p>这里<code>e</code>与<code>p-1</code>和<code>q-1</code>都不互素，不能简单地求个逆元就完事。</p>
<p>这种情况下，<strong>开平方根</strong>可以用<code>Tonelli–Shanks algorithm</code>，<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Tonelli–Shanks_algorithm">wiki</a>说这个算法可以<strong>扩展到开n次方根</strong>。</p>
<p>在这篇<a target="_blank" rel="noopener" href="https://arxiv.org/pdf/1111.4877.pdf">paper</a>里给出了具体的算法：<code>Adleman-Manders-Miller rth Root Extraction Method</code></p>
<blockquote>
<p>应该还有其他的算法。。不过这一个对我来说比较容易去implement。</p>
</blockquote>
<p><img src="https://i.loli.net/2020/04/18/QNy9EWc7K4enJGu.jpg" alt="Adleman-Manders-Miller cubic root extraction method"></p>
<p>这个算法只能开出一个根，实际上开0x1337次方，最多会有0x1337个根（这题的情况下有0x1337个根）。</p>
<p>如何找到其他根？<br><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/6752374/cube-root-modulo-p-how-do-i-do-this">StackOverflow – Cube root modulo P</a>给出了方法：</p>
<p><img src="https://i.loli.net/2020/04/18/lM6nyEOoiut7JB2.png" alt="How to find other roots"></p>
<p>如何找到所有的<code>primitve 0x1337th root of 1</code>?<br><a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/questions/63614/finding-the-n-th-root-of-unity-in-a-finite-field">StackExchange – Finding the n-th root of unity in a finite field</a>给出了方法：</p>
<p><img src="https://i.loli.net/2020/04/18/YHE1VsP4wbtr7Mf.jpg" alt="How to find primitive nth root of 1"></p>
<h4 id="Exploit"><a href="#Exploit" class="headerlink" title="Exploit"></a>Exploit</h4><ul>
<li>先用<code>Adleman-Manders-Miller rth Root Extraction Method</code>在<code>GF(p)</code>和<code>GF(q)</code>上对<code>c</code>开<code>e</code>次根，分别得到一个解。大概不到10秒。</li>
<li>然后去找到所有的<code>0x1336</code>个<code>primitive nth root of 1</code>，乘以上面那个解，得到所有的<code>0x1337</code>个解。大概1分钟。</li>
<li>再用<code>CRT</code>对<code>GF(p)</code>和<code>GF(q)</code>上的两组<code>0x1337</code>个解组合成<code>mod n</code>下的解，可以得到<code>0x1337**2==24196561</code>个<code>mod n</code>的解。最后能通过<code>check</code>的即为<code>flag</code>。大概十几分钟。</li>
</ul>
<p><code>exp.sage</code>如下：</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> random
<span class="token keyword">import</span> time

<span class="token comment"># About 3 seconds to run</span>
<span class="token keyword">def</span> <span class="token function">AMM</span><span class="token punctuation">(</span>o<span class="token punctuation">,</span> r<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n----------------------------------------------------------------------------------'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Start to run Adleman-Manders-Miller Root Extraction Method'</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Try to find one &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> o<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span>
    g <span class="token operator">=</span> GF<span class="token punctuation">(</span>q<span class="token punctuation">)</span>
    o <span class="token operator">=</span> g<span class="token punctuation">(</span>o<span class="token punctuation">)</span>
    p <span class="token operator">=</span> g<span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> p <span class="token operator">^</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> r<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        p <span class="token operator">=</span> g<span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Find p:&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
    t <span class="token operator">=</span> <span class="token number">0</span>
    s <span class="token operator">=</span> q <span class="token operator">-</span> <span class="token number">1</span>
    <span class="token keyword">while</span> s <span class="token operator">%</span> r <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        t <span class="token operator">+=</span> <span class="token number">1</span>
        s <span class="token operator">=</span> s <span class="token operator">//</span> r
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Find s:&#123;&#125;, t:&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span>
    k <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>k <span class="token operator">*</span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> r <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        k <span class="token operator">+=</span> <span class="token number">1</span>
    alp <span class="token operator">=</span> <span class="token punctuation">(</span>k <span class="token operator">*</span> s <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> r
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Find alp:&#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>alp<span class="token punctuation">)</span><span class="token punctuation">)</span>
    a <span class="token operator">=</span> p <span class="token operator">^</span> <span class="token punctuation">(</span>r<span class="token operator">**</span><span class="token punctuation">(</span>t<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> s<span class="token punctuation">)</span>
    b <span class="token operator">=</span> o <span class="token operator">^</span> <span class="token punctuation">(</span>r<span class="token operator">*</span>alp <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    c <span class="token operator">=</span> p <span class="token operator">^</span> s
    h <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> b <span class="token operator">^</span> <span class="token punctuation">(</span>r<span class="token operator">^</span><span class="token punctuation">(</span>t<span class="token operator">-</span><span class="token number">1</span><span class="token operator">-</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> d <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
            j <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Calculating DLP...'</span><span class="token punctuation">)</span>
            j <span class="token operator">=</span> <span class="token operator">-</span> dicreat_log<span class="token punctuation">(</span>a<span class="token punctuation">,</span> d<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Finish DLP...'</span><span class="token punctuation">)</span>
        b <span class="token operator">=</span> b <span class="token operator">*</span> <span class="token punctuation">(</span>c<span class="token operator">^</span>r<span class="token punctuation">)</span><span class="token operator">^</span>j
        h <span class="token operator">=</span> h <span class="token operator">*</span> c<span class="token operator">^</span>j
        c <span class="token operator">=</span> c <span class="token operator">^</span> r
    result <span class="token operator">=</span> o<span class="token operator">^</span>alp <span class="token operator">*</span> h
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished in &#123;&#125; seconds."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Find one solution: &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> result

<span class="token keyword">def</span> <span class="token function">findAllPRoot</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Start to find all the Primitive &#123;:#x&#125;th root of 1 modulo &#123;&#125;."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    proot <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>proot<span class="token punctuation">)</span> <span class="token operator">&lt;</span> e<span class="token punctuation">:</span>
        proot<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>e<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished in &#123;&#125; seconds."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> proot

<span class="token keyword">def</span> <span class="token function">findAllSolutions</span><span class="token punctuation">(</span>mp<span class="token punctuation">,</span> proot<span class="token punctuation">,</span> cp<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Start to find all the &#123;:#x&#125;th root of &#123;&#125; modulo &#123;&#125;."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> cp<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span>
    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    all_mp <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> root <span class="token keyword">in</span> proot<span class="token punctuation">:</span>
        mp2 <span class="token operator">=</span> mp <span class="token operator">*</span> root <span class="token operator">%</span> p
        <span class="token keyword">assert</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>mp2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">==</span> cp<span class="token punctuation">)</span>
        all_mp<span class="token punctuation">.</span>add<span class="token punctuation">(</span>mp2<span class="token punctuation">)</span>
    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished in &#123;&#125; seconds."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> all_mp


c <span class="token operator">=</span> <span class="token number">10562302690541901187975815594605242014385201583329309191736952454310803387032252007244962585846519762051885640856082157060593829013572592812958261432327975138581784360302599265408134332094134880789013207382277849503344042487389850373487656200657856862096900860792273206447552132458430989534820256156021128891296387414689693952047302604774923411425863612316726417214819110981605912408620996068520823370069362751149060142640529571400977787330956486849449005402750224992048562898004309319577192693315658275912449198365737965570035264841782399978307388920681068646219895287752359564029778568376881425070363592696751183359</span>
p <span class="token operator">=</span> <span class="token number">199138677823743837339927520157607820029746574557746549094921488292877226509198315016018919385259781238148402833316033634968163276198999279327827901879426429664674358844084491830543271625147280950273934405879341438429171453002453838897458102128836690385604150324972907981960626767679153125735677417397078196059</span>
q <span class="token operator">=</span> <span class="token number">112213695905472142415221444515326532320352429478341683352811183503269676555434601229013679319423878238944956830244386653674413411658696751173844443394608246716053086226910581400528167848306119179879115809778793093611381764939789057524575349501163689452810148280625226541609383166347879832134495444706697124741</span>
e <span class="token operator">=</span> <span class="token number">0x1337</span>
cp <span class="token operator">=</span> c <span class="token operator">%</span> p
cq <span class="token operator">=</span> c <span class="token operator">%</span> q
mp <span class="token operator">=</span> AMM<span class="token punctuation">(</span>cp<span class="token punctuation">,</span> e<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
mq <span class="token operator">=</span> AMM<span class="token punctuation">(</span>cq<span class="token punctuation">,</span> e<span class="token punctuation">,</span> q<span class="token punctuation">)</span>
p_proot <span class="token operator">=</span> findAllPRoot<span class="token punctuation">(</span>p<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
q_proot <span class="token operator">=</span> findAllPRoot<span class="token punctuation">(</span>q<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
mps <span class="token operator">=</span> findAllSolutions<span class="token punctuation">(</span>mp<span class="token punctuation">,</span> p_proot<span class="token punctuation">,</span> cp<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
mqs <span class="token operator">=</span> findAllSolutions<span class="token punctuation">(</span>mq<span class="token punctuation">,</span> q_proot<span class="token punctuation">,</span> cq<span class="token punctuation">,</span> q<span class="token punctuation">)</span>
<span class="token keyword">print</span> mps<span class="token punctuation">,</span> mqs

<span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    h <span class="token operator">=</span> m<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>
    <span class="token keyword">if</span> h<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'NCTF'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>h<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>


<span class="token comment"># About 16 mins to run 0x1337^2 == 24196561 times CRT</span>
start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Start CRT...'</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> mpp <span class="token keyword">in</span> mps<span class="token punctuation">:</span>
    <span class="token keyword">for</span> mqq <span class="token keyword">in</span> mqs<span class="token punctuation">:</span>
        solution <span class="token operator">=</span> CRT_list<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>mpp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>mqq<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> check<span class="token punctuation">(</span>solution<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>solution<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start<span class="token punctuation">)</span>

end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Finished in &#123;&#125; seconds."</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>end <span class="token operator">-</span> start<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">M4XLMUM</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://a16n.github.io/2020/11/25/BUUOJ-crypto/">https://a16n.github.io/2020/11/25/BUUOJ-crypto/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://a16n.github.io" target="_blank">M4XLMUM</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ctf/">ctf</a><a class="post-meta__tags" href="/tags/crypto/">crypto</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/11/25/ADWord-web%E8%BF%9B%E9%98%B6/"><img class="prev-cover" src="/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ADWord_web进阶</div></div></a></div><div class="next-post pull-right"><a href="/2020/11/24/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%20reverse%20%E7%AC%AC%E4%B8%80%E5%91%A8/"><img class="next-cover" src="/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">攻防世界 reverse 第一周</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/10/09/AFCTF2018-BASE/" title="AFCTF2018-BASE"><img class="cover" src="/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-10-09</div><div class="title">AFCTF2018-BASE</div></div></a></div><div><a href="/2020/10/25/BUUOJ部分密码题-一般RSA/" title="BUUOJ_密码_RSA"><img class="cover" src="/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-10-25</div><div class="title">BUUOJ_密码_RSA</div></div></a></div><div><a href="/2020/09/30/2019-Web-Unagi/" title="[CSAWQual 2019]Web_Unagi"><img class="cover" src="/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-30</div><div class="title">[CSAWQual 2019]Web_Unagi</div></div></a></div><div><a href="/2020/11/25/ADWord-web进阶/" title="ADWord_web进阶"><img class="cover" src="/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-25</div><div class="title">ADWord_web进阶</div></div></a></div><div><a href="/2020/11/03/BJDCTF-2nd-文件探测/" title="BJDCTF-2nd-文件探测"><img class="cover" src="/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-11-03</div><div class="title">BJDCTF-2nd-文件探测</div></div></a></div><div><a href="/2020/10/24/BJDCTF2020-EzPHP/" title="BJDCTF2020-EzPHP"><img class="cover" src="/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-10-24</div><div class="title">BJDCTF2020-EzPHP</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E6%95%B4%E5%90%88"><span class="toc-number">1.</span> <span class="toc-text">资源整合</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%AF%86%E7%A0%81%E5%AD%A6%E7%BD%91%E5%9D%80"><span class="toc-number">1.1.</span> <span class="toc-text">1.密码学网址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-number">1.2.</span> <span class="toc-text">2.知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8Crypto-PublicKey%E7%9A%84RSA%E6%A8%A1%E5%9D%97%E4%BB%8E%E6%96%87%E4%BB%B6%E4%B8%AD%E8%8E%B7%E5%8F%96%E5%85%AC%E9%92%A5%E4%BF%A1%E6%81%AFn-e%E3%80%82"><span class="toc-number">1.2.1.</span> <span class="toc-text">利用Crypto.PublicKey的RSA模块从文件中获取公钥信息n,e。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%E8%A7%A3%E5%AF%86%EF%BC%8C%E9%9B%86%E6%88%90PKCS1-OAEP"><span class="toc-number">1.2.2.</span> <span class="toc-text">对文件内容解密，集成PKCS1_OAEP</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">古典密码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%8F%A4%E5%85%B8-Cipher"><span class="toc-number">2.1.</span> <span class="toc-text">1.古典-Cipher</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E5%8F%A4%E5%85%B8-%E6%B1%89%E5%AD%97%E7%9A%84%E7%A7%98%E5%AF%86"><span class="toc-number">2.2.</span> <span class="toc-text">2.古典-汉字的秘密</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E8%8E%AB%E6%96%AF-robomunication"><span class="toc-number">2.3.</span> <span class="toc-text">3.莫斯-robomunication</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%85%AB%E8%BF%9B%E5%88%B6%E4%B8%8EASCII-%E5%AF%86%E7%A0%81%E5%AD%A6%E7%9A%84%E5%BF%83%E5%A3%B0"><span class="toc-number">2.4.</span> <span class="toc-text">4.八进制与ASCII-密码学的心声</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81-%E4%BC%A0%E6%84%9F%E5%99%A8"><span class="toc-number">2.5.</span> <span class="toc-text">5.曼彻斯特编码-传感器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E5%8F%98%E5%BD%A2rot%E5%8A%A0%E5%AF%86-rot"><span class="toc-number">2.6.</span> <span class="toc-text">6.变形rot加密-rot</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E5%8F%98%E5%BD%A2base64-BJDCTF2020-%E8%BF%99%E6%98%AFbase"><span class="toc-number">2.7.</span> <span class="toc-text">7.变形base64-[BJDCTF2020]这是base??</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-jsfuck-%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">2.8.</span> <span class="toc-text">8.jsfuck-()[]+!-这是什么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81-MRCTF2020-vigenere"><span class="toc-number">2.9.</span> <span class="toc-text">9.维吉尼亚密码-[MRCTF2020]vigenere</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81-AFCTF2018-Vigenere"><span class="toc-number">2.10.</span> <span class="toc-text">维吉尼亚密码-[AFCTF2018]Vigenère</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A8%A1%E8%BF%90%E7%AE%97"><span class="toc-number">3.</span> <span class="toc-text">模运算</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%A8%A1%E8%BF%90%E7%AE%97-%E5%B0%8F%E5%AD%A6%E7%94%9F%E7%9A%84%E5%AF%86%E7%A0%81%E5%AD%A6"><span class="toc-number">3.1.</span> <span class="toc-text">1.模运算-小学生的密码学</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%97%E9%A2%91%E5%88%86%E6%9E%90"><span class="toc-number">4.</span> <span class="toc-text">字频分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90-BJDCTF-2nd-Y1nglish-y1ng"><span class="toc-number">4.1.</span> <span class="toc-text">1.词频分析-[BJDCTF 2nd]Y1nglish-y1ng</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90-%E4%B8%96%E4%B8%8A%E6%97%A0%E9%9A%BE%E4%BA%8B"><span class="toc-number">4.2.</span> <span class="toc-text">2.词频分析-世上无难事</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E5%AF%86%E7%A0%81"><span class="toc-number">5.</span> <span class="toc-text">其他密码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%96%87%E4%BB%B6%E5%BC%82%E6%88%96-%E5%BC%82%E6%80%A7%E7%9B%B8%E5%90%B8"><span class="toc-number">5.1.</span> <span class="toc-text">1.文件异或-异性相吸</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%96%87%E4%BB%B6%E5%BC%82%E6%88%96-yxx"><span class="toc-number">5.2.</span> <span class="toc-text">2.文件异或-yxx</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-md5%E7%88%86%E7%A0%B4-%E8%BF%98%E5%8E%9F%E5%A4%A7%E5%B8%88"><span class="toc-number">5.3.</span> <span class="toc-text">3.md5爆破-还原大师</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B5%B7%E6%98%8E%E7%A0%81%E3%80%81%E5%A5%87%E5%81%B6%E6%A0%A1%E9%AA%8C%E7%A0%81-%E9%B8%A1%E8%97%95%E6%A4%92%E7%9B%90%E5%91%B3"><span class="toc-number">5.4.</span> <span class="toc-text">海明码、奇偶校验码-鸡藕椒盐味</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RSA"><span class="toc-number">6.</span> <span class="toc-text">RSA</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-RSA%E5%9F%BA%E7%A1%80-GUET-CTF2019-BabyRSA"><span class="toc-number">6.1.</span> <span class="toc-text">2.RSA基础-[GUET-CTF2019]BabyRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-RSA%E5%9F%BA%E7%A1%80-ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-crypto-rsa0"><span class="toc-number">6.2.</span> <span class="toc-text">3.RSA基础-[ACTF新生赛2020]crypto-rsa0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E5%9F%BA%E7%A1%80-AFCTF2018-%E4%BD%A0%E8%83%BD%E7%9C%8B%E5%87%BA%E8%BF%99%E6%98%AF%E4%BB%80%E4%B9%88%E5%8A%A0%E5%AF%86%E4%B9%88"><span class="toc-number">6.3.</span> <span class="toc-text">RSA基础-[AFCTF2018]你能看出这是什么加密么</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E5%9F%BA%E7%A1%80-ACTF%E6%96%B0%E7%94%9F%E8%B5%9B2020-crypto-rsa3"><span class="toc-number">6.4.</span> <span class="toc-text">RSA基础-[ACTF新生赛2020]crypto-rsa3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E5%9F%BA%E7%A1%80-BJDCTF2020-easyrsa"><span class="toc-number">6.5.</span> <span class="toc-text">RSA基础-[BJDCTF2020]easyrsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E6%96%87%E4%BB%B6%E5%88%86%E8%A7%A3%E5%85%AC%E9%92%A5%E4%BF%A1%E6%81%AF-AFCTF2018-%E5%8F%AF%E6%80%9C%E7%9A%84RSA"><span class="toc-number">6.6.</span> <span class="toc-text">RSA文件分解公钥信息-[AFCTF2018]可怜的RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E5%A4%A7%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3-RoarCTF2019-RSA"><span class="toc-number">6.7.</span> <span class="toc-text">RSA大整数分解-[RoarCTF2019]RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-RSA%E5%A4%A7%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3-rsa2"><span class="toc-number">6.8.</span> <span class="toc-text">4.RSA大整数分解-rsa2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-RSA%E5%A4%A7%E6%95%B4%E6%95%B0%E5%88%86%E8%A7%A3-RSAROLL"><span class="toc-number">6.9.</span> <span class="toc-text">5.RSA大整数分解-RSAROLL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-WUSTCTF2020-babyrsa"><span class="toc-number">6.10.</span> <span class="toc-text">6.[WUSTCTF2020]babyrsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%8E%E5%8A%A0%E5%AF%86%E6%8C%87%E6%95%B0%E5%B9%BF%E6%92%AD%E6%94%BB%E5%87%BB-RSA4"><span class="toc-number">6.11.</span> <span class="toc-text">低加密指数广播攻击-RSA4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-RSA%E5%B0%8F%E5%85%AC%E9%92%A5%E6%8C%87%E6%95%B0%E6%94%BB%E5%87%BB-Dangerous-RSA"><span class="toc-number">6.12.</span> <span class="toc-text">7.RSA小公钥指数攻击-Dangerous RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-RSA%E4%B8%80%E4%B8%AA%E6%98%8E%E6%96%87%E5%A4%9A%E7%BB%84n%E4%B8%8Ec-RSA5"><span class="toc-number">6.13.</span> <span class="toc-text">8.RSA一个明文多组n与c-RSA5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E7%89%B9%E6%AE%8A%E6%A8%A1%E6%95%B0-p%E3%80%81q%E6%B1%82%E6%B3%95%E5%B7%B2%E7%9F%A5-NCTF2019-childRSA"><span class="toc-number">6.14.</span> <span class="toc-text">9.特殊模数(p、q求法已知)-[NCTF2019]childRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-RSA%E7%BB%99%E5%87%BAe%E8%8C%83%E5%9B%B4%EF%BC%8C%E7%88%86%E7%A0%B4e-HDCTF2019-bbbbbbrsa"><span class="toc-number">6.15.</span> <span class="toc-text">10.RSA给出e范围，爆破e-[HDCTF2019]bbbbbbrsa</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-RSA%E4%B8%A4%E6%AC%A1%E5%8A%A0%E5%AF%86n%E6%9C%89%E5%85%AC%E5%9B%A0%E6%95%B0%E3%80%81e%E4%B8%8D%E5%8F%98%E4%B8%94%E5%8F%AF%E6%B1%82-BJDCTF2020-RSA"><span class="toc-number">6.16.</span> <span class="toc-text">11.RSA两次加密n有公因数、e不变且可求-[BJDCTF2020]RSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-RSA%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB-BJDCTF2020-rsa-output"><span class="toc-number">6.17.</span> <span class="toc-text">12.RSA共模攻击-[BJDCTF2020]rsa_output</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-RSA%E5%85%B1%E6%A8%A1%E6%94%BB%E5%87%BB-SameMod"><span class="toc-number">6.18.</span> <span class="toc-text">13.RSA共模攻击-SameMod</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-RSA%E7%94%9F%E6%88%90%E7%B4%A0%E6%95%B0p%E3%80%81q%E7%9B%B8%E8%B7%9D%E5%BE%88%E8%BF%91%EF%BC%9B%E8%A7%A3%E6%96%B9%E7%A8%8B%E7%BB%84sympy%E5%BA%93-GWCTF-2019-BabyRSA"><span class="toc-number">6.19.</span> <span class="toc-text">14.RSA生成素数p、q相距很近；解方程组sympy库-[GWCTF 2019]BabyRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E6%9C%89c%E3%80%81d%E3%80%81e%EF%BC%8C%E5%B9%B6%E4%B8%94p%E3%80%81q%E7%9B%B8%E8%B7%9D%E5%BE%88%E8%BF%91%EF%BC%8C%E7%88%86%E7%A0%B4e-d-1-k-p-1-q-1-%E4%B8%AD%E7%9A%84k-NCTF2019-babyRSA"><span class="toc-number">6.20.</span> <span class="toc-text">RSA有c、d、e，并且p、q相距很近，爆破e*d-1&#x3D;k*(p-1)*(q-1)中的k-[NCTF2019]babyRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E5%AD%98%E5%9C%A8%E9%98%B6%E4%B9%98%E4%B8%80%E8%88%AC%E5%8F%AF%E8%83%BD%E6%98%AF%E5%A8%81%E5%B0%94%E9%80%8A%E5%AE%9A%E7%90%86-RoarCTF2019-babyRSA"><span class="toc-number">6.21.</span> <span class="toc-text">RSA存在阶乘一般可能是威尔逊定理-[RoarCTF2019]babyRSA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E5%9F%BA%E7%A1%80-BJDCTF-2nd-rsa0"><span class="toc-number">6.22.</span> <span class="toc-text">RSA基础-[BJDCTF 2nd]rsa0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E5%90%84%E7%A7%8D%E8%84%9A%E6%9C%AC%E8%AE%A1%E7%AE%97%E6%96%B9%E7%A8%8B%E7%BB%84-BJDCTF-2nd-rsa1"><span class="toc-number">6.23.</span> <span class="toc-text">RSA各种脚本计算方程组-[BJDCTF 2nd]rsa1</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#C%E8%AF%AD%E8%A8%80%E5%86%99%E7%9A%84%E5%AF%86%E7%A0%81-%E5%88%86%E6%9E%90"><span class="toc-number">7.</span> <span class="toc-text">C语言写的密码-分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%95%E8%A1%A8%E6%9B%BF%E6%8D%A2%E5%AF%86%E7%A0%81-AFCTF2018-Single"><span class="toc-number">7.1.</span> <span class="toc-text">单表替换密码-[AFCTF2018]Single</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%9C%9F%E6%AD%A3%E7%9A%84%E5%85%B6%E4%BB%96-%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E7%9A%84"><span class="toc-number">8.</span> <span class="toc-text">真正的其他-奇奇怪怪的</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-sage%E6%B1%82%E6%96%B9%E7%A8%8B%E7%BB%84%E3%80%81matlab%E6%B1%82%E6%96%B9%E7%A8%8B-%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-boom"><span class="toc-number">8.1.</span> <span class="toc-text">1.sage求方程组、matlab求方程[网鼎杯 2020 青龙组]boom</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-base%E8%A1%A8%E7%88%86%E7%A0%B4-python-%EF%BC%8C-WUSTCTF2020-B-se"><span class="toc-number">8.2.</span> <span class="toc-text">2.base表爆破(python)，[WUSTCTF2020]B@se</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RSA%E4%B9%8Bp-1%E5%8F%AF%E6%95%B4%E9%99%A4e%E3%80%81%E5%BC%80%E5%A4%A7%E6%AC%A1%E6%96%B9%E6%A0%B9-NCTF2019-easyRSA"><span class="toc-number">8.3.</span> <span class="toc-text">RSA之p-1可整除e、开大次方根-[NCTF2019]easyRSA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Exploit"><span class="toc-number">8.3.0.1.</span> <span class="toc-text">Exploit</span></a></li></ol></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer" style="background-image: url('/img/topimg/QQ%E6%88%AA%E5%9B%BE20210503194649.png')"><div id="footer-wrap"><div class="copyright">&copy;2021 By M4XLMUM</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    loader: {
      source: {
        '[tex]/amsCd': '[tex]/amscd'
      }
    },
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        addClass: [200,() => {
          document.querySelectorAll('mjx-container:not([display=\'true\']').forEach( node => {
            const target = node.parentNode
            if (!target.classList.contains('has-jax')) {
              target.classList.add('mathjax-overflow')
            }
          })
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'hQSVii4djRLOjBYaCK5zOXhB-gzGzoHsz',
      appKey: 'eaCREaPBTzvLpmQcrAhlnzGe',
      placeholder: '记得留下你的昵称和邮箱....可以快速收到回复',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: true,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: true,
      path: window.location.pathname,
      requiredFields: ["nick"],
      visitor: true
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>